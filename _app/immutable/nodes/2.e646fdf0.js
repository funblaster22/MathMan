import{s as F,n as D,e as T,f as U,o as W}from"../chunks/scheduler.03df403d.js";import{S as z,i as A,e as q,a as $,d as b,p as X,b as Y,t as k,f as d,y as Z,g as m,m as H,s as y,r as V,h as p,j as g,n as J,c as w,u as j,k as h,l as M,x as _,v as I,o as Q,w as P}from"../chunks/index.5bc90a32.js";import{e as E,p as S,u as x,a as ee,d as L,b as te,n as le}from"../chunks/index.83a2109c.js";import{e as N,r as ae}from"../chunks/singletons.c457f596.js";import{p as se}from"../chunks/stores.ce72b9db.js";function O(i,l,s){const r=i.slice();return r[3]=l[s],r}function C(i){let l,s=(i[3]||"/")+"",r,n,f,e,a;return e=new R({props:{fileStruct:i[0][i[3]],indentLevel:i[1]+1,fullPath:S.join(i[2],i[3])}}),{c(){l=m("a"),r=H(s),f=y(),V(e.$$.fragment),this.h()},l(t){l=p(t,"A",{href:!0,class:!0});var o=g(l);r=J(o,s),o.forEach(d),f=w(t),j(e.$$.fragment,t),this.h()},h(){h(l,"href",n=S.join("/",N,i[2],i[3])),h(l,"class","w-full block text-left"),M(l,"padding-left",i[1]*15+"px")},m(t,o){$(t,l,o),_(l,r),$(t,f,o),I(e,t,o),a=!0},p(t,o){(!a||o&1)&&s!==(s=(t[3]||"/")+"")&&Q(r,s),(!a||o&5&&n!==(n=S.join("/",N,t[2],t[3])))&&h(l,"href",n),o&2&&M(l,"padding-left",t[1]*15+"px");const c={};o&1&&(c.fileStruct=t[0][t[3]]),o&2&&(c.indentLevel=t[1]+1),o&5&&(c.fullPath=S.join(t[2],t[3])),e.$set(c)},i(t){a||(b(e.$$.fragment,t),a=!0)},o(t){k(e.$$.fragment,t),a=!1},d(t){t&&(d(l),d(f)),P(e,t)}}}function ne(i){let l,s,r=E(Object.keys(i[0]??{})),n=[];for(let e=0;e<r.length;e+=1)n[e]=C(O(i,r,e));const f=e=>k(n[e],1,1,()=>{n[e]=null});return{c(){for(let e=0;e<n.length;e+=1)n[e].c();l=q()},l(e){for(let a=0;a<n.length;a+=1)n[a].l(e);l=q()},m(e,a){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,a);$(e,l,a),s=!0},p(e,[a]){if(a&7){r=E(Object.keys(e[0]??{}));let t;for(t=0;t<r.length;t+=1){const o=O(e,r,t);n[t]?(n[t].p(o,a),b(n[t],1)):(n[t]=C(o),n[t].c(),b(n[t],1),n[t].m(l.parentNode,l))}for(X(),t=r.length;t<n.length;t+=1)f(t);Y()}},i(e){if(!s){for(let a=0;a<r.length;a+=1)b(n[a]);s=!0}},o(e){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)k(n[a]);s=!1},d(e){e&&d(l),Z(n,e)}}}function re(i,l,s){let{fileStruct:r}=l,{indentLevel:n=0}=l,{fullPath:f=""}=l;return i.$$set=e=>{"fileStruct"in e&&s(0,r=e.fileStruct),"indentLevel"in e&&s(1,n=e.indentLevel),"fullPath"in e&&s(2,f=e.fullPath)},[r,n,f]}class R extends z{constructor(l){super(),A(this,l,re,ne,F,{fileStruct:0,indentLevel:1,fullPath:2})}}function K(i,l,s){const r=i.slice();return r[3]=l[s],r}function G(i,l){let s,r,n,f,e=l[3].name+"",a,t,o;return{key:i,first:null,c(){s=m("a"),r=m("div"),n=y(),f=m("div"),a=H(e),t=y(),this.h()},l(c){s=p(c,"A",{class:!0,href:!0});var u=g(s);r=p(u,"DIV",{class:!0}),g(r).forEach(d),n=w(u),f=p(u,"DIV",{});var v=g(f);a=J(v,e),v.forEach(d),t=w(u),u.forEach(d),this.h()},h(){h(r,"class","w-12 h-12 bg-red-500 m-auto"),h(s,"class","text-center"),h(s,"href",o=l[3].id),this.first=s},m(c,u){$(c,s,u),_(s,r),_(s,n),_(s,f),_(f,a),_(s,t)},p(c,u){l=c,u&2&&e!==(e=l[3].name+"")&&Q(a,e),u&2&&o!==(o=l[3].id)&&h(s,"href",o)},d(c){c&&d(s)}}}function ie(i){let l,s=[],r=new Map,n=E(i[1]);const f=e=>e[3].id;for(let e=0;e<n.length;e+=1){let a=K(i,n,e),t=f(a);r.set(t,s[e]=G(t,a))}return{c(){l=m("div");for(let e=0;e<s.length;e+=1)s[e].c();this.h()},l(e){l=p(e,"DIV",{class:!0});var a=g(l);for(let t=0;t<s.length;t+=1)s[t].l(a);a.forEach(d),this.h()},h(){h(l,"class","flex flex-wrap gap-5")},m(e,a){$(e,l,a);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(l,null)},p(e,[a]){a&2&&(n=E(e[1]),s=x(s,a,f,1,e,n,r,l,te,G,null,K))},i:D,o:D,d(e){e&&d(l);for(let a=0;a<s.length;a+=1)s[a].d()}}}function fe(i,l,s){let r,n,f=D,e=()=>(f(),f=U(a,t=>s(1,n=t)),a);T(i,se,t=>s(2,r=t)),i.$$.on_destroy.push(()=>f());let a=ae([]);return e(),i.$$.update=()=>{i.$$.dirty&4&&e(s(0,a=ee(()=>L.files.where({"[route]":[["",...r.params.path.split("/")]]}).toArray())))},[a,n,r]}class oe extends z{constructor(l){super(),A(this,l,fe,ie,F,{})}}function ce(i){let l,s,r,n,f,e,a,t,o;return f=new R({props:{fileStruct:i[0]}}),t=new oe({}),{c(){l=m("div"),s=m("div"),r=y(),n=m("div"),V(f.$$.fragment),e=y(),a=m("div"),V(t.$$.fragment),this.h()},l(c){l=p(c,"DIV",{id:!0,class:!0});var u=g(l);s=p(u,"DIV",{id:!0,class:!0}),g(s).forEach(d),r=w(u),n=p(u,"DIV",{id:!0,class:!0});var v=g(n);j(f.$$.fragment,v),v.forEach(d),e=w(u),a=p(u,"DIV",{id:!0,class:!0});var B=g(a);j(t.$$.fragment,B),B.forEach(d),u.forEach(d),this.h()},h(){h(s,"id","ribbon"),h(s,"class","svelte-1huhyzt"),h(n,"id","folders"),h(n,"class","svelte-1huhyzt"),h(a,"id","files"),h(a,"class","svelte-1huhyzt"),h(l,"id","grid"),h(l,"class","svelte-1huhyzt")},m(c,u){$(c,l,u),_(l,s),_(l,r),_(l,n),I(f,n,null),_(l,e),_(l,a),I(t,a,null),o=!0},p(c,[u]){const v={};u&1&&(v.fileStruct=c[0]),f.$set(v)},i(c){o||(b(f.$$.fragment,c),b(t.$$.fragment,c),o=!0)},o(c){k(f.$$.fragment,c),k(t.$$.fragment,c),o=!1},d(c){c&&d(l),P(f),P(t)}}}function ue(i,l,s){let r={};async function n(){const e={},a=await L.files.orderBy("[route]").uniqueKeys().then(t=>t.flat(1));for(const t of a){let o=e;for(const c of t)c in o||(o[c]={}),o=o[c]}return e}function f(...e){if(e.length<1){console.error("Need at least filename");return}L.files.add({attempts:[le()],parent:e.at(-2)??"",route:["",...e.slice(0,e.length-1)],name:e.at(-1)})}return W(()=>{window.newFile=f,n().then(e=>s(0,r=e))}),[r]}class ge extends z{constructor(l){super(),A(this,l,ue,ce,F,{})}}export{ge as component};
