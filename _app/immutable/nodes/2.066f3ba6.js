import{s as be,n as Z,e as ze,f as Le,o as Ne}from"../chunks/scheduler.21a3a156.js";import{S as we,i as ke,e as Se,a as T,d as L,p as qe,b as Oe,t as K,f as _,y as Ce,g as v,m as y,s as D,r as de,h as m,j as g,n as $,c as E,u as _e,k as d,l as Ae,x as u,v as ve,o as X,w as me,z as Fe,A as Ue,B as Ye}from"../chunks/index.5cde54b0.js";import{u as Ke,d as pe}from"../chunks/db.0a5d7a2c.js";import{e as Y,p as U,u as We,d as Ge,n as He}from"../chunks/index.5530884e.js";import{e as ge}from"../chunks/singletons.91314f9b.js";import{p as Je}from"../chunks/stores.ac5a8961.js";function je(o,e,l){const s=o.slice();return s[3]=e[l],s}function Me(o){let e,l=(o[3]||"/")+"",s,n,f,a,i;return a=new Pe({props:{fileStruct:o[0][o[3]],indentLevel:o[1]+1,fullPath:U.join(o[2],o[3])}}),{c(){e=v("a"),s=y(l),f=D(),de(a.$$.fragment),this.h()},l(t){e=m(t,"A",{href:!0,class:!0});var r=g(e);s=$(r,l),r.forEach(_),f=E(t),_e(a.$$.fragment,t),this.h()},h(){d(e,"href",n=U.join("/",ge,o[2],o[3])),d(e,"class","w-full block text-left"),Ae(e,"padding-left",o[1]*15+"px")},m(t,r){T(t,e,r),u(e,s),T(t,f,r),ve(a,t,r),i=!0},p(t,r){(!i||r&1)&&l!==(l=(t[3]||"/")+"")&&X(s,l),(!i||r&5&&n!==(n=U.join("/",ge,t[2],t[3])))&&d(e,"href",n),r&2&&Ae(e,"padding-left",t[1]*15+"px");const c={};r&1&&(c.fileStruct=t[0][t[3]]),r&2&&(c.indentLevel=t[1]+1),r&5&&(c.fullPath=U.join(t[2],t[3])),a.$set(c)},i(t){i||(L(a.$$.fragment,t),i=!0)},o(t){K(a.$$.fragment,t),i=!1},d(t){t&&(_(e),_(f)),me(a,t)}}}function Qe(o){let e,l,s=Y(Object.keys(o[0]??{})),n=[];for(let a=0;a<s.length;a+=1)n[a]=Me(je(o,s,a));const f=a=>K(n[a],1,1,()=>{n[a]=null});return{c(){for(let a=0;a<n.length;a+=1)n[a].c();e=Se()},l(a){for(let i=0;i<n.length;i+=1)n[i].l(a);e=Se()},m(a,i){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(a,i);T(a,e,i),l=!0},p(a,[i]){if(i&7){s=Y(Object.keys(a[0]??{}));let t;for(t=0;t<s.length;t+=1){const r=je(a,s,t);n[t]?(n[t].p(r,i),L(n[t],1)):(n[t]=Me(r),n[t].c(),L(n[t],1),n[t].m(e.parentNode,e))}for(qe(),t=s.length;t<n.length;t+=1)f(t);Oe()}},i(a){if(!l){for(let i=0;i<s.length;i+=1)L(n[i]);l=!0}},o(a){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)K(n[i]);l=!1},d(a){a&&_(e),Ce(n,a)}}}function Re(o,e,l){let{fileStruct:s}=e,{indentLevel:n=0}=e,{fullPath:f=""}=e;return o.$$set=a=>{"fileStruct"in a&&l(0,s=a.fileStruct),"indentLevel"in a&&l(1,n=a.indentLevel),"fullPath"in a&&l(2,f=a.fullPath)},[s,n,f]}class Pe extends we{constructor(e){super(),ke(this,e,Re,Qe,be,{fileStruct:0,indentLevel:1,fullPath:2})}}function Xe(o,e,l){const s=o.slice();return s[3]=e[l],s}function Te(o,e,l){const s=o.slice();s[6]=e[l];const n=U.join("/",ge,s[0].params.path,s[6].id.toString());s[7]=n;const f=et(s[6]);return s[8]=f,s}function Be(o,e){let l,s,n,f,a,i,t=R(e[8])+"",r,c,h,k,B,N="77",p,I,b,z,S=e[6].attempts.length+"",C,W,x,A,ee,ye="5",te,le,j,ae,$e="3",se,G,ne,M,De="🔻",re,F,q,O=e[6].name+"",H,J,ie;return{key:o,first:null,c(){l=v("div"),s=v("div"),n=v("a"),f=v("div"),a=v("div"),i=y("-"),r=y(t),h=D(),k=v("div"),B=y("⏱️ "),p=y(N),I=D(),b=v("div"),z=y("✏️ "),C=y(S),W=v("div"),x=D(),A=v("div"),ee=y("❔ "),te=y(ye),le=D(),j=v("div"),ae=y("❌ "),se=y($e),ne=D(),M=v("button"),M.textContent=De,re=D(),F=v("a"),q=v("div"),H=y(O),ie=D(),this.h()},l(P){l=m(P,"DIV",{class:!0});var w=g(l);s=m(w,"DIV",{class:!0});var Q=g(s);n=m(Q,"A",{href:!0});var Ee=g(n);f=m(Ee,"DIV",{class:!0});var V=g(f);a=m(V,"DIV",{class:!0,title:!0});var oe=g(a);i=$(oe,"-"),r=$(oe,t),oe.forEach(_),h=E(V),k=m(V,"DIV",{class:!0,title:!0});var fe=g(k);B=$(fe,"⏱️ "),p=$(fe,N),fe.forEach(_),I=E(V),b=m(V,"DIV",{class:!0,title:!0});var ce=g(b);z=$(ce,"✏️ "),C=$(ce,S),ce.forEach(_),W=m(V,"DIV",{}),g(W).forEach(_),x=E(V),A=m(V,"DIV",{class:!0,title:!0});var ue=g(A);ee=$(ue,"❔ "),te=$(ue,ye),ue.forEach(_),le=E(V),j=m(V,"DIV",{class:!0,title:!0});var he=g(j);ae=$(he,"❌ "),se=$(he,$e),he.forEach(_),V.forEach(_),Ee.forEach(_),ne=E(Q),M=m(Q,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),Fe(M)!=="svelte-g19542"&&(M.textContent=De),Q.forEach(_),re=E(w),F=m(w,"A",{href:!0});var Ve=g(F);q=m(Ve,"DIV",{});var Ie=g(q);H=$(Ie,O),Ie.forEach(_),Ve.forEach(_),ie=E(w),w.forEach(_),this.h()},h(){d(a,"class","m-auto"),d(a,"title",c="Time since last attempt ("+R(e[8],!1)+")"),d(k,"class","m-auto"),d(k,"title","Duration of last attempt"),d(b,"class","m-auto"),d(b,"title","Number of attempts"),d(A,"class","m-auto"),d(A,"title","Number of unresolved questions"),d(j,"class","m-auto"),d(j,"title","Weighted average of incorrect problems"),d(f,"class","w-full aspect-square border m-auto grid grid-cols-2 grid-rows-3"),d(n,"href",G=e[7]),d(M,"class","attempt-dropdown svelte-wqw3oy"),d(M,"title","Show attempts"),d(s,"class","relative"),d(F,"href",J=e[7]),d(l,"class","text-center w-[6rem] mr-[11px]"),this.first=l},m(P,w){T(P,l,w),u(l,s),u(s,n),u(n,f),u(f,a),u(a,i),u(a,r),u(f,h),u(f,k),u(k,B),u(k,p),u(f,I),u(f,b),u(b,z),u(b,C),u(f,W),u(f,x),u(f,A),u(A,ee),u(A,te),u(f,le),u(f,j),u(j,ae),u(j,se),u(s,ne),u(s,M),u(l,re),u(l,F),u(F,q),u(q,H),u(l,ie)},p(P,w){e=P,w&4&&t!==(t=R(e[8])+"")&&X(r,t),w&4&&c!==(c="Time since last attempt ("+R(e[8],!1)+")")&&d(a,"title",c),w&4&&S!==(S=e[6].attempts.length+"")&&X(C,S),w&5&&G!==(G=e[7])&&d(n,"href",G),w&4&&O!==(O=e[6].name+"")&&X(H,O),w&5&&J!==(J=e[7])&&d(F,"href",J)},d(P){P&&_(l)}}}function Ze(o){let e;return{c(){e=v("div"),this.h()},l(l){e=m(l,"DIV",{class:!0}),g(e).forEach(_),this.h()},h(){d(e,"class","w-[6rem] mr-[11px]")},m(l,s){T(l,e,s)},p:Z,d(l){l&&_(e)}}}function xe(o){let e,l=[],s=new Map,n,f=Y(o[2]??[]);const a=r=>r[6].id;for(let r=0;r<f.length;r+=1){let c=Te(o,f,r),h=a(c);s.set(h,l[r]=Be(h,c))}let i=Y(Array(10)),t=[];for(let r=0;r<i.length;r+=1)t[r]=Ze(Xe(o,i,r));return{c(){e=v("div");for(let r=0;r<l.length;r+=1)l[r].c();n=D();for(let r=0;r<t.length;r+=1)t[r].c();this.h()},l(r){e=m(r,"DIV",{class:!0});var c=g(e);for(let h=0;h<l.length;h+=1)l[h].l(c);n=E(c);for(let h=0;h<t.length;h+=1)t[h].l(c);c.forEach(_),this.h()},h(){d(e,"class","flex flex-wrap justify-evenly gap-3")},m(r,c){T(r,e,c);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(e,null);u(e,n);for(let h=0;h<t.length;h+=1)t[h]&&t[h].m(e,null)},p(r,[c]){c&5&&(f=Y(r[2]??[]),l=We(l,c,a,1,r,f,s,e,Ge,Be,n,Te))},i:Z,o:Z,d(r){r&&_(e);for(let c=0;c<l.length;c+=1)l[c].d();Ce(t,r)}}}function et(o){return o.attempts.length===0?new Date:o.attempts.reduce((e,l)=>l.date>e?l.date:e,new Date(0))}function R(o,e=!0){const l=new Date,s=(l.getTime()-o.getTime())/(1e3*60*60*24);if(s<=10)return Math.floor(s)+(e?"d":" days");const n=s/7;if(n<=16)return Math.floor(n)+(e?"w":" weeks");const a=(l.getFullYear()-o.getFullYear())*12+(l.getMonth()-o.getMonth());return a<12?a+(e?"m":" months"):Math.floor(a/12)+(e?"y":" years")}function tt(o,e,l){let s,n,f=Z,a=()=>(f(),f=Le(i,t=>l(2,n=t)),i);ze(o,Je,t=>l(0,s=t)),o.$$.on_destroy.push(()=>f());let i;return o.$$.update=()=>{o.$$.dirty&1&&a(l(1,i=Ke(()=>pe.files.where({"[route]":[["",...s.params.path?s.params.path.split("/"):[]]]}).toArray())))},[s,i,n]}class lt extends we{constructor(e){super(),ke(this,e,tt,xe,be,{})}}function at(o){let e,l,s,n,f="➕ file",a,i,t,r,c,h,k,B,N;return t=new Pe({props:{fileStruct:o[0]}}),h=new lt({}),{c(){e=D(),l=v("div"),s=v("div"),n=v("button"),n.textContent=f,a=D(),i=v("div"),de(t.$$.fragment),r=D(),c=v("div"),de(h.$$.fragment),this.h()},l(p){Ue("svelte-8s10wx",document.head).forEach(_),e=E(p),l=m(p,"DIV",{id:!0,class:!0});var b=g(l);s=m(b,"DIV",{id:!0,class:!0});var z=g(s);n=m(z,"BUTTON",{"data-svelte-h":!0}),Fe(n)!=="svelte-k3nzco"&&(n.textContent=f),z.forEach(_),a=E(b),i=m(b,"DIV",{id:!0,class:!0});var S=g(i);_e(t.$$.fragment,S),S.forEach(_),r=E(b),c=m(b,"DIV",{id:!0,class:!0});var C=g(c);_e(h.$$.fragment,C),C.forEach(_),b.forEach(_),this.h()},h(){document.title="MathMan Browse",d(s,"id","ribbon"),d(s,"class","text-right svelte-1huhyzt"),d(i,"id","folders"),d(i,"class","svelte-1huhyzt"),d(c,"id","files"),d(c,"class","svelte-1huhyzt"),d(l,"id","grid"),d(l,"class","svelte-1huhyzt")},m(p,I){T(p,e,I),T(p,l,I),u(l,s),u(s,n),u(l,a),u(l,i),ve(t,i,null),u(l,r),u(l,c),ve(h,c,null),k=!0,B||(N=Ye(n,"click",o[2]),B=!0)},p(p,[I]){const b={};I&1&&(b.fileStruct=p[0]),t.$set(b)},i(p){k||(L(t.$$.fragment,p),L(h.$$.fragment,p),k=!0)},o(p){K(t.$$.fragment,p),K(h.$$.fragment,p),k=!1},d(p){p&&(_(e),_(l)),me(t),me(h),B=!1,N()}}}function st(o,e,l){let s={};async function n(){const i={},t=await pe.files.orderBy("[route]").uniqueKeys().then(r=>r.flat(1));for(const r of t){let c=i;for(const h of r)h in c||(c[h]={}),c=c[h]}return i}function f(...i){var t;if(i.length===0){if(((t=prompt("Enter path of file to create"))==null?void 0:t.split("/"))==null)return;if(i.length===0)throw"Need at least filename"}pe.files.add({attempts:[He()],parent:i.at(-2)??"",route:["",...i.slice(0,i.length-1)],name:i.at(-1)})}return Ne(()=>{n().then(i=>l(0,s=i))}),[s,f,()=>f()]}class ut extends we{constructor(e){super(),ke(this,e,st,at,be,{})}}export{ut as component};
