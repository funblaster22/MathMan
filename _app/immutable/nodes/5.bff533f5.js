import{s as $,n as O,j as ce,e as K,k as Le,l as Ne,o as qe,f as Se,b as ie,m as Qe,r as je}from"../chunks/scheduler.a731e211.js";import{S as ee,i as te,s as j,g as D,c as z,h as M,A as fe,k as v,l as Q,a as E,z as F,C as ye,f as b,j as q,x as A,r as B,m as Z,u as Y,n as x,v as X,d as P,t as U,w as G,D as _e,o as he,y as pe,E as ge,F as ze,p as Re,b as Oe,B as We}from"../chunks/index.f53a124d.js";import{p as se,e as ne,u as He,o as Pe}from"../chunks/index.73019456.js";import{e as re,j as Ue,w as be,k as we}from"../chunks/singletons.10b20637.js";import{p as ue}from"../chunks/stores.85fe49b8.js";import{d as J,u as Ve,D as Fe}from"../chunks/db.fc1c3249.js";var S=(n=>(n[n.Draw=0]="Draw",n[n.Correct=1]="Correct",n[n.Question=2]="Question",n[n.None=3]="None",n[n.Select=4]="Select",n))(S||{});const Be=""+new URL("../assets/eraser.0e084288.png",import.meta.url).href;function ve(n){let e,t="Show Solution";return{c(){e=D("button"),e.textContent=t,this.h()},l(s){e=M(s,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),fe(e)!=="svelte-on8fyx"&&(e.textContent=t),this.h()},h(){v(e,"class","border text-center"),Q(e,"position","fixed"),Q(e,"left",n[1][0]+"px"),Q(e,"top",n[1][1]+"px"),Q(e,"width",n[2][0]-n[1][0]+"px"),Q(e,"height",n[2][1]-n[1][1]+"px")},m(s,l){E(s,e,l)},p(s,l){l&2&&Q(e,"left",s[1][0]+"px"),l&2&&Q(e,"top",s[1][1]+"px"),l&6&&Q(e,"width",s[2][0]-s[1][0]+"px"),l&6&&Q(e,"height",s[2][1]-s[1][1]+"px")},d(s){s&&b(e)}}}function Ye(n){let e,t,s='<div style="background-color: green">‚úÖ</div>',l,i,o=n[1][1]&&ve(n);return{c(){o&&o.c(),e=j(),t=D("div"),t.innerHTML=s,this.h()},l(a){o&&o.l(a),e=z(a),t=M(a,"DIV",{class:!0,"data-svelte-h":!0}),fe(t)!=="svelte-aiv1v7"&&(t.innerHTML=s),this.h()},h(){v(t,"class","tool"),Q(t,"height",n[0]?"100%":"30px")},m(a,r){o&&o.m(a,r),E(a,e,r),E(a,t,r),l||(i=F(t,"pointerdown",ye(n[8])),l=!0)},p(a,[r]){a[1][1]?o?o.p(a,r):(o=ve(a),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),r&1&&Q(t,"height",a[0]?"100%":"30px")},i:O,o:O,d(a){a&&(b(e),b(t)),o&&o.d(a),l=!1,i()}}}function Xe(n,e,t){let s;const l=S.Select;let i=!1,o=!1,a=[],r=[],u,c,p=ce("selection");K(n,p,I=>t(7,s=I)),window.addEventListener("pointerdown",I=>{i&&(o=!0,t(5,a=t(6,r=[I.x,I.y])))}),window.addEventListener("pointermove",I=>{o&&t(6,r=[I.x,I.y])}),window.addEventListener("pointerup",()=>{o=!1});const d=()=>p.set(i?S.None:l);return n.$$.update=()=>{n.$$.dirty&128&&t(0,i=s===l),n.$$.dirty&96&&(t(1,u=[Math.min(a[0],r[0]),Math.min(a[1],r[1])]),t(2,c=[Math.max(a[0],r[0]),Math.max(a[1],r[1])]))},[i,u,c,l,p,a,r,s,d]}class Ge extends ee{constructor(e){super(),te(this,e,Xe,Ye,$,{})}}const Je=""+new URL("../assets/marker.c9b3b178.png",import.meta.url).href;function Ke(n){let e,t,s,l,i;return{c(){e=D("div"),t=D("img"),this.h()},l(o){e=M(o,"DIV",{class:!0});var a=q(e);t=M(a,"IMG",{style:!0,src:!0,title:!0,draggable:!0}),a.forEach(b),this.h()},h(){Q(t,"filter",n[1]),Le(t.src,s=Je)||v(t,"src",s),v(t,"title",n[2]),v(t,"draggable","false"),v(e,"class","tool"),Q(e,"height",n[3]?"100%":"30px")},m(o,a){E(o,e,a),A(e,t),l||(i=F(e,"pointerdown",ye(n[6])),l=!0)},p(o,[a]){a&2&&Q(t,"filter",o[1]),a&4&&v(t,"title",o[2]),a&8&&Q(e,"height",o[3]?"100%":"30px")},i:O,o:O,d(o){o&&b(e),l=!1,i()}}}function Ze(n,e,t){let s,{tool:l}=e,{filter:i=""}=e,{title:o}=e,a=ce("selection");K(n,a,c=>t(5,s=c));let r=!1;const u=()=>a.set(r?S.None:l);return n.$$set=c=>{"tool"in c&&t(0,l=c.tool),"filter"in c&&t(1,i=c.filter),"title"in c&&t(2,o=c.title)},n.$$.update=()=>{n.$$.dirty&33&&t(3,r=s===l)},[l,i,o,r,a,s,u]}class de extends ee{constructor(e){super(),te(this,e,Ze,Ke,$,{tool:0,filter:1,title:2})}}function xe(n){let e,t,s,l,i,o,a,r,u,c,p,d,I,C,k=`<img src="${Be}" title="Eraser" draggable="false" class="svelte-h3rgmi"/>`,T,m,f;return t=new Ge({}),r=new de({props:{tool:S.Draw,filter:"grayscale(1)",title:"Your work"}}),c=new de({props:{tool:S.Correct,filter:"hue-rotate(136deg)",title:"Correct"}}),d=new de({props:{tool:S.Question,title:"Question"}}),{c(){e=D("div"),B(t.$$.fragment),s=j(),l=D("a"),i=Z("üì∑"),a=j(),B(r.$$.fragment),u=j(),B(c.$$.fragment),p=j(),B(d.$$.fragment),I=j(),C=D("div"),C.innerHTML=k,this.h()},l(g){e=M(g,"DIV",{id:!0,class:!0});var h=q(e);Y(t.$$.fragment,h),s=z(h),l=M(h,"A",{href:!0});var y=q(l);i=x(y,"üì∑"),y.forEach(b),a=z(h),Y(r.$$.fragment,h),u=z(h),Y(c.$$.fragment,h),p=z(h),Y(d.$$.fragment,h),I=z(h),C=M(h,"DIV",{class:!0,"data-svelte-h":!0}),fe(C)!=="svelte-19p7wft"&&(C.innerHTML=k),h.forEach(b),this.h()},h(){v(l,"href",o=se.join("/",re,"camera",n[1].params.problemId)),v(C,"class","tool"),Q(C,"height",n[0]?"100%":"30px"),v(e,"id","tools"),v(e,"class","svelte-h3rgmi")},m(g,h){E(g,e,h),X(t,e,null),A(e,s),A(e,l),A(l,i),A(e,a),X(r,e,null),A(e,u),X(c,e,null),A(e,p),X(d,e,null),A(e,I),A(e,C),T=!0,m||(f=F(C,"click",n[3]),m=!0)},p(g,[h]){(!T||h&2&&o!==(o=se.join("/",re,"camera",g[1].params.problemId)))&&v(l,"href",o),h&1&&Q(C,"height",g[0]?"100%":"30px")},i(g){T||(P(t.$$.fragment,g),P(r.$$.fragment,g),P(c.$$.fragment,g),P(d.$$.fragment,g),T=!0)},o(g){U(t.$$.fragment,g),U(r.$$.fragment,g),U(c.$$.fragment,g),U(d.$$.fragment,g),T=!1},d(g){g&&b(e),G(t),G(r),G(c),G(d),m=!1,f()}}}function $e(n,e,t){let s,l;K(n,ue,r=>t(1,l=r));let{selected:i}=e;Ne("selection",i);let o=ce("eraserEnabled");K(n,o,r=>t(0,s=r));function a(r){o.set(!s)}return n.$$set=r=>{"selected"in r&&t(4,i=r.selected)},[s,l,o,a,i]}class et extends ee{constructor(e){super(),te(this,e,$e,xe,$,{selected:4})}}function tt(n){let e,t,s,l,i,o,a;return{c(){e=D("canvas"),t=j(),s=D("canvas"),l=j(),i=D("canvas"),this.h()},l(r){e=M(r,"CANVAS",{width:!0,height:!0,class:!0}),q(e).forEach(b),t=z(r),s=M(r,"CANVAS",{width:!0,height:!0,class:!0}),q(s).forEach(b),l=z(r),i=M(r,"CANVAS",{width:!0,height:!0,class:!0}),q(i).forEach(b),this.h()},h(){v(e,"width",n[2]),v(e,"height",n[3]),v(e,"class","svelte-1rofrvo"),v(s,"width",n[2]),v(s,"height",n[3]),v(s,"class","svelte-1rofrvo"),v(i,"width",n[2]),v(i,"height",n[3]),v(i,"class","svelte-1rofrvo")},m(r,u){E(r,e,u),n[8](e),E(r,t,u),E(r,s,u),n[9](s),E(r,l,u),E(r,i,u),n[10](i),o||(a=F(i,"pointerdown",n[5]),o=!0)},p(r,[u]){u&4&&v(e,"width",r[2]),u&8&&v(e,"height",r[3]),u&4&&v(s,"width",r[2]),u&8&&v(s,"height",r[3]),u&4&&v(i,"width",r[2]),u&8&&v(i,"height",r[3])},i:O,o:O,d(r){r&&(b(e),b(t),b(s),b(l),b(i)),n[8](null),n[9](null),n[10](null),o=!1,a()}}}function nt(n,e,t){let s,l=O,i=()=>(l(),l=Se(a,_=>t(13,s=_)),a),o;n.$$.on_destroy.push(()=>l());let{selectedTool:a}=e;i();let{problemId:r}=e,{attemptId:u}=e,c=0,p=0,d=!1,I=ce("eraserEnabled");K(n,I,_=>t(14,o=_));let C,k=[];function T(){typeof window>"u"||(t(2,c=window.innerWidth),t(3,p=window.innerHeight),requestAnimationFrame(async()=>{if(k[0]==null)return;const _=(await J.files.get(r)).attempts[u];k[S.Draw].putImageData(_.work,0,0),k[S.Correct].putImageData(_.error,0,0),k[S.Question].putImageData(_.questions,0,0)}))}const m=()=>{const _=[0,0,c,p];J.files.update(r,N=>{const H=N.attempts[u];H.date=new Date,H.duration=Math.floor((new Date().getTime()-C)/1e3/60),s==S.Correct&&(H.mistakeCount=1),s==S.Question&&(H.questionCount=1),H[["work","error","questions"][s]]=k[s].getImageData(..._)})},f=typeof window>"u"?!1:window.matchMedia("(prefers-color-scheme: dark)").matches,g={[S.Draw]:f?"white":"black",[S.Correct]:"red",[S.Question]:"blue"},h=_=>{if(s>=S.None)return;const N=k[s];d=!0,N.strokeStyle=g[s],N.lineWidth=o?20:1,N.globalCompositeOperation=o?"destination-out":"source-over",N.beginPath(),N.moveTo(_.clientX,_.clientY)},y=()=>{d&&m(),d=!1},R=_=>{if(d){const N=k[s];N.lineTo(_.clientX,_.clientY),N.stroke()}};qe(()=>{window.addEventListener("resize",T),document.addEventListener("pointermove",R),document.addEventListener("pointerup",y),t(1,k=k.map(_=>_.getContext("2d",{willReadFrequently:!0})))});function V(_){ie[_?"unshift":"push"](()=>{k[S.Draw]=_,t(1,k)})}function w(_){ie[_?"unshift":"push"](()=>{k[S.Correct]=_,t(1,k)})}function L(_){ie[_?"unshift":"push"](()=>{k[S.Question]=_,t(1,k)})}return n.$$set=_=>{"selectedTool"in _&&i(t(0,a=_.selectedTool)),"problemId"in _&&t(6,r=_.problemId),"attemptId"in _&&t(7,u=_.attemptId)},n.$$.update=()=>{if(n.$$.dirty&194){T(),C=new Date().getTime();for(const _ of k){const N=_.canvas;_.clearRect(0,0,N.width,N.height)}}},[a,k,c,p,I,h,r,u,V,w,L]}class st extends ee{constructor(e){super(),te(this,e,nt,tt,$,{selectedTool:0,problemId:6,attemptId:7})}}const le=Ue("goto");function ke(n,e,t){const s=n.slice();return s[14]=e[t],s}function Ie(n,e,t){const s=n.slice();return s[17]=e[t],s}function Ce(n){let e,t=n[4][n[17]]+"",s;return{c(){e=D("option"),s=Z(t),this.h()},l(l){e=M(l,"OPTION",{});var i=q(e);s=x(i,t),i.forEach(b),this.h()},h(){e.__value=n[17],ge(e,e.__value)},m(l,i){E(l,e,i),A(e,s)},p:O,d(l){l&&b(e)}}}function Ee(n){let e,t=n[14].name+"",s,l,i;return{c(){e=D("option"),s=Z(t),this.h()},l(o){e=M(o,"OPTION",{});var a=q(e);s=x(a,t),a.forEach(b),this.h()},h(){e.__value=l=n[14].id,ge(e,e.__value),e.selected=i=n[14].name===n[2]},m(o,a){E(o,e,a),A(e,s)},p(o,a){a&8&&t!==(t=o[14].name+"")&&he(s,t),a&8&&l!==(l=o[14].id)&&(e.__value=l,ge(e,e.__value)),a&12&&i!==(i=o[14].name===o[2])&&(e.selected=i)},d(o){o&&b(e)}}}function rt(n){let e,t=n[1]?new Date().getMonth()===5?"üè≥Ô∏è‚Äçüåà":"üö©":"üè≥Ô∏è",s,l,i,o,a,r,u,c,p="‚û°Ô∏è",d,I,C=ne(Object.keys(n[4])),k=[];for(let f=0;f<C.length;f+=1)k[f]=Ce(Ie(n,C,f));let T=ne(n[3]),m=[];for(let f=0;f<T.length;f+=1)m[f]=Ee(ke(n,T,f));return{c(){e=D("button"),s=Z(t),i=j(),o=D("select");for(let f=0;f<k.length;f+=1)k[f].c();a=j(),r=D("select");for(let f=0;f<m.length;f+=1)m[f].c();u=j(),c=D("button"),c.textContent=p,this.h()},l(f){e=M(f,"BUTTON",{title:!0});var g=q(e);s=x(g,t),g.forEach(b),i=z(f),o=M(f,"SELECT",{});var h=q(o);for(let R=0;R<k.length;R+=1)k[R].l(h);h.forEach(b),a=z(f),r=M(f,"SELECT",{});var y=q(r);for(let R=0;R<m.length;R+=1)m[R].l(y);y.forEach(b),u=z(f),c=M(f,"BUTTON",{"data-svelte-h":!0}),fe(c)!=="svelte-1wjt799"&&(c.textContent=p),this.h()},h(){v(e,"title",l=(n[1]?"un":"")+"flag for later"),n[0]===void 0&&Qe(()=>n[12].call(o))},m(f,g){E(f,e,g),A(e,s),E(f,i,g),E(f,o,g);for(let h=0;h<k.length;h+=1)k[h]&&k[h].m(o,null);_e(o,n[0],!0),E(f,a,g),E(f,r,g);for(let h=0;h<m.length;h+=1)m[h]&&m[h].m(r,null);E(f,u,g),E(f,c,g),d||(I=[F(e,"click",n[7]),F(o,"change",n[12]),F(r,"change",n[5]),F(c,"click",n[6])],d=!0)},p(f,[g]){if(g&2&&t!==(t=f[1]?new Date().getMonth()===5?"üè≥Ô∏è‚Äçüåà":"üö©":"üè≥Ô∏è")&&he(s,t),g&2&&l!==(l=(f[1]?"un":"")+"flag for later")&&v(e,"title",l),g&16){C=ne(Object.keys(f[4]));let h;for(h=0;h<C.length;h+=1){const y=Ie(f,C,h);k[h]?k[h].p(y,g):(k[h]=Ce(y),k[h].c(),k[h].m(o,null))}for(;h<k.length;h+=1)k[h].d(1);k.length=C.length}if(g&17&&_e(o,f[0]),g&12){T=ne(f[3]);let h;for(h=0;h<T.length;h+=1){const y=ke(f,T,h);m[h]?m[h].p(y,g):(m[h]=Ee(y),m[h].c(),m[h].m(r,null))}for(;h<m.length;h+=1)m[h].d(1);m.length=T.length}},i:O,o:O,d(f){f&&(b(e),b(i),b(o),b(a),b(r),b(u),b(c)),pe(k,f),pe(m,f),d=!1,je(I)}}}function lt(n,e,t){let s,l;K(n,ue,m=>t(13,l=m));var i=(m=>(m.Work="Work",m.Mistakes="Mistakes",m.Questions="Questions",m))(i||{});let{problemRoute:o}=e,{problemId:a}=e,r="Work",u=!1,c;function p(m){const f=m.target.value;le(f)}function d(){switch(r){case"Work":const m=Array.from(c.matchAll(/\d+/g)).at(-1);let f;m!=null&&(f=c.substring(0,m.index)+(Number.parseInt(m[0])+1)+c.substring(m.index+m[0].length)),J.newFile({basePath:l.params.path,route:f}).then(g=>{g>=0&&le(String(g))})}}function I(){t(1,u=!u),J.files.update(a,{flagged:u})}const C=Ve(()=>J.files.where("route").startsWith(l.params.path).toArray().then(m=>m.map(f=>({id:f.id,route:f.route,name:f.name,attempts:f.attempts.map(g=>({questions:g.questionCount,mistakes:g.mistakeCount}))}))));K(n,C,m=>t(11,s=m));let k=[];function T(){r=ze(this),t(0,r),t(4,i)}return n.$$set=m=>{"problemRoute"in m&&t(9,o=m.problemRoute),"problemId"in m&&t(10,a=m.problemId)},n.$$.update=()=>{if(n.$$.dirty&1024&&J.files.get(a).then(m=>{t(1,u=(m==null?void 0:m.flagged)??!1),t(2,c=(m==null?void 0:m.name)??"")}),n.$$.dirty&2561){const m=s??[];switch(r){case"Work":t(3,k=m.filter(f=>f.route===o).sort((f,g)=>f.name.localeCompare(g.name)));break;case"Mistakes":t(3,k=m.filter(f=>f.attempts.at(-1).mistakes>0));break;case"Questions":t(3,k=m.filter(f=>f.attempts.some(g=>g.questions>0)));break}}},[r,u,c,k,i,p,d,I,C,o,a,s,T]}class ot extends ee{constructor(e){super(),te(this,e,lt,rt,$,{problemRoute:9,problemId:10})}}function at(n){let e,t,s,l,i=n[0]+1+"",o;return{c(){e=D("div"),t=D("canvas"),l=Z(`
    Attempt `),o=Z(i),this.h()},l(a){e=M(a,"DIV",{class:!0});var r=q(e);t=M(r,"CANVAS",{width:!0,height:!0}),q(t).forEach(b),l=x(r,`
    Attempt `),o=x(r,i),r.forEach(b),this.h()},h(){v(t,"width",n[1]),v(t,"height",s=n[1]-24),v(e,"class","text-center bg-gray-50 rounded-md"),Q(e,"width",n[1]+"px")},m(a,r){E(a,e,r),A(e,t),n[4](t),A(e,l),A(e,o)},p(a,[r]){r&2&&v(t,"width",a[1]),r&2&&s!==(s=a[1]-24)&&v(t,"height",s),r&1&&i!==(i=a[0]+1+"")&&he(o,i),r&2&&Q(e,"width",a[1]+"px")},i:O,o:O,d(a){a&&b(e),n[4](null)}}}function it(n,e,t){let{attempt:s}=e,{idx:l}=e,{size:i=100}=e,o;function a(u,c){const p=document.createElement("canvas");p.width=c[0].width,p.height=c[0].height,u.scale(i/p.width,(i-24)/p.height);for(const d of c)p.getContext("2d").putImageData(d,0,0),u.drawImage(p,0,0)}qe(async()=>{const u=o.getContext("2d");a(u,[s.work,s.error,s.questions])});function r(u){ie[u?"unshift":"push"](()=>{o=u,t(2,o)})}return n.$$set=u=>{"attempt"in u&&t(3,s=u.attempt),"idx"in u&&t(0,l=u.idx),"size"in u&&t(1,i=u.size)},[l,i,o,s,r]}class ut extends ee{constructor(e){super(),te(this,e,it,at,$,{attempt:3,idx:0,size:1})}}function De(n,e,t){const s=n.slice();return s[5]=e[t],s[7]=t,s}function Me(n,e){let t,s,l,i,o;s=new ut({props:{attempt:e[5],idx:e[7]}});function a(){return e[4](e[7])}return{key:n,first:null,c(){t=D("div"),B(s.$$.fragment),this.h()},l(r){t=M(r,"DIV",{});var u=q(t);Y(s.$$.fragment,u),u.forEach(b),this.h()},h(){this.first=t},m(r,u){E(r,t,u),X(s,t,null),l=!0,i||(o=F(t,"click",a),i=!0)},p(r,u){e=r;const c={};u&4&&(c.attempt=e[5]),u&4&&(c.idx=e[7]),s.$set(c)},i(r){l||(P(s.$$.fragment,r),l=!0)},o(r){U(s.$$.fragment,r),l=!1},d(r){r&&b(t),G(s),i=!1,o()}}}function ft(n){let e=[],t=new Map,s,l,i=`<div class="w-[100px] h-[76px] align-middle text-5xl leading-[1.65]">‚ûï</div>
    New Attempt`,o,a,r,u=ne(n[2]??[]);const c=p=>""+p[0]+p[7];for(let p=0;p<u.length;p+=1){let d=De(n,u,p),I=c(d);t.set(I,e[p]=Me(I,d))}return{c(){for(let p=0;p<e.length;p+=1)e[p].c();s=j(),l=D("div"),l.innerHTML=i,this.h()},l(p){for(let d=0;d<e.length;d+=1)e[d].l(p);s=z(p),l=M(p,"DIV",{class:!0,"data-svelte-h":!0}),fe(l)!=="svelte-59ttd9"&&(l.innerHTML=i),this.h()},h(){v(l,"class","text-center bg-gray-50 rounded-md w-[100px]")},m(p,d){for(let I=0;I<e.length;I+=1)e[I]&&e[I].m(p,d);E(p,s,d),E(p,l,d),o=!0,a||(r=F(l,"click",n[3]),a=!0)},p(p,[d]){d&5&&(u=ne(p[2]??[]),Re(),e=He(e,d,c,1,p,u,t,s.parentNode,Pe,Me,s,De),Oe())},i(p){if(!o){for(let d=0;d<u.length;d+=1)P(e[d]);o=!0}},o(p){for(let d=0;d<e.length;d+=1)U(e[d]);o=!1},d(p){p&&(b(s),b(l));for(let d=0;d<e.length;d+=1)e[d].d(p);a=!1,r()}}}function ct(n,e,t){let s,l=O,i=()=>(l(),l=Se(a,c=>t(2,s=c)),a);n.$$.on_destroy.push(()=>l());let{problemId:o}=e,a;function r(){J.files.update(o,c=>{le("?attempt="+c.attempts.push(Fe.newBlankAttempt()))})}const u=c=>le("?attempt="+(c+1));return n.$$set=c=>{"problemId"in c&&t(0,o=c.problemId)},n.$$.update=()=>{n.$$.dirty&1&&i(t(1,a=Ve(()=>J.files.get(o).then(c=>c.attempts))))},[o,a,s,r,u]}class ht extends ee{constructor(e){super(),te(this,e,ct,ft,$,{problemId:0})}}function mt(n){let e,t,s;return{c(){e=D("canvas"),this.h()},l(l){e=M(l,"CANVAS",{class:!0}),q(e).forEach(b),this.h()},h(){v(e,"class","fixed left-0 top-[2em]")},m(l,i){E(l,e,i),n[3](e),t||(s=F(e,"mousedown",n[1]),t=!0)},p:O,i:O,o:O,d(l){l&&b(e),n[3](null),t=!1,s()}}}function dt(n,e,t){let{problemId:s}=e,l,i;function o(r){setTimeout(()=>{i.dragStart(r)})}function a(r){ie[r?"unshift":"push"](()=>{l=r,t(0,l),t(2,s)})}return n.$$set=r=>{"problemId"in r&&t(2,s=r.problemId)},n.$$.update=()=>{n.$$.dirty&5&&J.files.get(s).then(r=>{r!=null&&r.question&&(t(0,l.width=r.question.width,l),t(0,l.height=r.question.height,l),l.getContext("2d").putImageData(r.question,0,0))})},[l,o,s,a]}class pt extends ee{constructor(e){super(),te(this,e,dt,mt,$,{problemId:2})}}function Te(n,e,t){const s=n.slice();return s[9]=e[t],s}function Ae(n){let e,t=n[9]+"",s;return{c(){e=Z("/"),s=Z(t)},l(l){e=x(l,"/"),s=x(l,t)},m(l,i){E(l,e,i),E(l,s,i)},p(l,i){i&4&&t!==(t=l[9]+"")&&he(s,t)},d(l){l&&(b(e),b(s))}}}function gt(n){let e,t,s,l,i,o,a,r,u,c,p,d,I,C,k,T,m,f,g,h,y;t=new pt({props:{problemId:n[0]}}),l=new st({props:{selectedTool:n[4],problemId:n[0],attemptId:n[3]}});let R=ne(n[2].params.path.split("/")),V=[];for(let w=0;w<R.length;w+=1)V[w]=Ae(Te(n,R,w));return C=new ot({props:{problemId:n[0],problemRoute:n[1]}}),m=new et({props:{selected:n[4]}}),h=new ht({props:{problemId:n[0]}}),{c(){e=j(),B(t.$$.fragment),s=j(),B(l.$$.fragment),i=j(),o=D("div"),a=D("div"),r=D("a"),u=Z("üè†"),p=j();for(let w=0;w<V.length;w+=1)V[w].c();d=j(),I=D("div"),B(C.$$.fragment),k=j(),T=D("div"),B(m.$$.fragment),f=j(),g=D("div"),B(h.$$.fragment),this.h()},l(w){We("svelte-pyemm1",document.head).forEach(b),e=z(w),Y(t.$$.fragment,w),s=z(w),Y(l.$$.fragment,w),i=z(w),o=M(w,"DIV",{id:!0,class:!0});var _=q(o);a=M(_,"DIV",{id:!0,class:!0});var N=q(a);r=M(N,"A",{href:!0});var H=q(r);u=x(H,"üè†"),H.forEach(b),p=z(N);for(let me=0;me<V.length;me+=1)V[me].l(N);N.forEach(b),d=z(_),I=M(_,"DIV",{id:!0,class:!0});var oe=q(I);Y(C.$$.fragment,oe),oe.forEach(b),k=z(_),T=M(_,"DIV",{id:!0,class:!0});var W=q(T);Y(m.$$.fragment,W),W.forEach(b),f=z(_),g=M(_,"DIV",{id:!0,class:!0});var ae=q(g);Y(h.$$.fragment,ae),ae.forEach(b),_.forEach(b),this.h()},h(){document.title="MathMan Draw",v(r,"href",c=se.join("/",re,n[2].params.path)),v(a,"id","breadcrumbs"),v(a,"class","svelte-1edzgew"),v(I,"id","question-management"),v(I,"class","text-right svelte-1edzgew"),v(T,"id","tools-container"),v(T,"class","svelte-1edzgew"),v(g,"id","attempts-container"),v(g,"class","flex flex-col p-3 gap-3 svelte-1edzgew"),v(o,"id","grid"),v(o,"class","svelte-1edzgew")},m(w,L){E(w,e,L),X(t,w,L),E(w,s,L),X(l,w,L),E(w,i,L),E(w,o,L),A(o,a),A(a,r),A(r,u),A(a,p);for(let _=0;_<V.length;_+=1)V[_]&&V[_].m(a,null);A(o,d),A(o,I),X(C,I,null),A(o,k),A(o,T),X(m,T,null),A(o,f),A(o,g),X(h,g,null),y=!0},p(w,[L]){const _={};L&1&&(_.problemId=w[0]),t.$set(_);const N={};if(L&1&&(N.problemId=w[0]),L&8&&(N.attemptId=w[3]),l.$set(N),(!y||L&4&&c!==(c=se.join("/",re,w[2].params.path)))&&v(r,"href",c),L&4){R=ne(w[2].params.path.split("/"));let W;for(W=0;W<R.length;W+=1){const ae=Te(w,R,W);V[W]?V[W].p(ae,L):(V[W]=Ae(ae),V[W].c(),V[W].m(a,null))}for(;W<V.length;W+=1)V[W].d(1);V.length=R.length}const H={};L&1&&(H.problemId=w[0]),L&2&&(H.problemRoute=w[1]),C.$set(H);const oe={};L&1&&(oe.problemId=w[0]),h.$set(oe)},i(w){y||(P(t.$$.fragment,w),P(l.$$.fragment,w),P(C.$$.fragment,w),P(m.$$.fragment,w),P(h.$$.fragment,w),y=!0)},o(w){U(t.$$.fragment,w),U(l.$$.fragment,w),U(C.$$.fragment,w),U(m.$$.fragment,w),U(h.$$.fragment,w),y=!1},d(w){w&&(b(e),b(s),b(i),b(o)),G(t,w),G(l,w),pe(V,w),G(C),G(m),G(h)}}}function _t(n,e,t){let s,l,i;K(n,ue,d=>t(2,l=d));const o=be(S.None),a=be(!1);Ne("eraserEnabled",a);const r=we(ue,d=>Number.parseInt(d.params.problemId));K(n,r,d=>t(0,s=d));const u=we(ue,d=>Number.parseInt(d.url.searchParams.get("attempt")??"1")-1);K(n,u,d=>t(3,i=d));let c;function p(d){d?(t(1,c=d.route),c.startsWith(l.params.path)||le(se.join("/",re,c,l.params.problemId))):le(se.join("/",re,l.params.path))}return n.$$.update=()=>{n.$$.dirty&1&&typeof window<"u"&&J.files.get(s).then(p)},[s,c,l,i,o,r,u]}class Et extends ee{constructor(e){super(),te(this,e,_t,gt,$,{})}}export{Et as component};
