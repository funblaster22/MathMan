import{s as ue,i as He,n as X,e as ae,f as $e,r as Je,o as Qe,h as Re}from"../chunks/scheduler.a731e211.js";import{S as ce,i as he,e as se,a as T,d as z,p as Ke,b as We,t as $,f as g,y as Se,g as b,m as D,s as V,r as re,h as k,j as E,n as S,c as I,u as ie,k as m,l as qe,x as d,v as oe,o as N,w as fe,z as Ve,A as Ie,B as Xe}from"../chunks/index.f53a124d.js";import{D as Ze,d as R,u as xe}from"../chunks/db.fc1c3249.js";import{e as U,p as Y,u as et,o as tt}from"../chunks/index.73019456.js";import{e as Z,w as lt}from"../chunks/singletons.10b20637.js";import{p as Ae}from"../chunks/stores.85fe49b8.js";function Fe(a,e,l){const t=a.slice();return t[3]=e[l],t}function Pe(a){let e,l=(a[3]||"/")+"",t,s,f,r,o;return r=new Ge({props:{fileStruct:a[0][a[3]],indentLevel:a[1]+1,fullPath:Y.join(a[2],a[3])}}),{c(){e=b("a"),t=D(l),f=V(),re(r.$$.fragment),this.h()},l(n){e=k(n,"A",{href:!0,class:!0});var c=E(e);t=S(c,l),c.forEach(g),f=I(n),ie(r.$$.fragment,n),this.h()},h(){m(e,"href",s=Y.join("/",Z,a[2],a[3])),m(e,"class","w-full block text-left"),qe(e,"padding-left",a[1]*15+"px")},m(n,c){T(n,e,c),d(e,t),T(n,f,c),oe(r,n,c),o=!0},p(n,c){(!o||c&1)&&l!==(l=(n[3]||"/")+"")&&N(t,l),(!o||c&5&&s!==(s=Y.join("/",Z,n[2],n[3])))&&m(e,"href",s),c&2&&qe(e,"padding-left",n[1]*15+"px");const _={};c&1&&(_.fileStruct=n[0][n[3]]),c&2&&(_.indentLevel=n[1]+1),c&5&&(_.fullPath=Y.join(n[2],n[3])),r.$set(_)},i(n){o||(z(r.$$.fragment,n),o=!0)},o(n){$(r.$$.fragment,n),o=!1},d(n){n&&(g(e),g(f)),fe(r,n)}}}function nt(a){let e,l,t=U(Object.keys(a[0]??{})),s=[];for(let r=0;r<t.length;r+=1)s[r]=Pe(Fe(a,t,r));const f=r=>$(s[r],1,1,()=>{s[r]=null});return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=se()},l(r){for(let o=0;o<s.length;o+=1)s[o].l(r);e=se()},m(r,o){for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(r,o);T(r,e,o),l=!0},p(r,[o]){if(o&7){t=U(Object.keys(r[0]??{}));let n;for(n=0;n<t.length;n+=1){const c=Fe(r,t,n);s[n]?(s[n].p(c,o),z(s[n],1)):(s[n]=Pe(c),s[n].c(),z(s[n],1),s[n].m(e.parentNode,e))}for(Ke(),n=t.length;n<s.length;n+=1)f(n);We()}},i(r){if(!l){for(let o=0;o<t.length;o+=1)z(s[o]);l=!0}},o(r){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)$(s[o]);l=!1},d(r){r&&g(e),Se(s,r)}}}function at(a,e,l){let{fileStruct:t}=e,{indentLevel:s=0}=e,{fullPath:f=""}=e;return a.$$set=r=>{"fileStruct"in r&&l(0,t=r.fileStruct),"indentLevel"in r&&l(1,s=r.indentLevel),"fullPath"in r&&l(2,f=r.fullPath)},[t,s,f]}class Ge extends ce{constructor(e){super(),he(this,e,at,nt,ue,{fileStruct:0,indentLevel:1,fullPath:2})}}function st(a){let e,l,t,s,f,r,o=Oe(a[4].date)+"",n,c,_,p,v=a[4].duration+"",i,h,u,B,q=a[0].attempts.length+"",w,C,A,y,K,F=a[0].attempts.reduce(ze,0)+"",x,de,P,_e,je=a[4].mistakeCount+"",me,ve,O,H=a[2]?"üóëÔ∏è":"üîª",ee,ge,W,G,J=a[0].flagged?new Date().getMonth()===5?"üè≥Ô∏è‚Äçüåà ":"üö© ":"",te,Q=a[0].name+"",le,pe,Ce;return{c(){e=b("div"),l=b("div"),t=b("a"),s=b("div"),f=b("div"),r=D("-"),n=D(o),c=V(),_=b("div"),p=D("‚è±Ô∏è "),i=D(v),h=V(),u=b("div"),B=D("‚úèÔ∏è "),w=D(q),C=b("div"),A=V(),y=b("div"),K=D("‚ùî "),x=D(F),de=V(),P=b("div"),_e=D("‚ùå "),me=D(je),ve=V(),O=b("button"),ee=D(H),ge=V(),W=b("a"),G=b("div"),te=D(J),le=D(Q),this.h()},l(L){e=k(L,"DIV",{class:!0});var j=E(e);l=k(j,"DIV",{class:!0});var ne=E(l);t=k(ne,"A",{href:!0});var Me=E(t);s=k(Me,"DIV",{class:!0});var M=E(s);f=k(M,"DIV",{class:!0,title:!0});var be=E(f);r=S(be,"-"),n=S(be,o),be.forEach(g),c=I(M),_=k(M,"DIV",{class:!0,title:!0});var ke=E(_);p=S(ke,"‚è±Ô∏è "),i=S(ke,v),ke.forEach(g),h=I(M),u=k(M,"DIV",{class:!0,title:!0});var we=E(u);B=S(we,"‚úèÔ∏è "),w=S(we,q),we.forEach(g),C=k(M,"DIV",{}),E(C).forEach(g),A=I(M),y=k(M,"DIV",{class:!0,title:!0});var Ee=E(y);K=S(Ee,"‚ùî "),x=S(Ee,F),Ee.forEach(g),de=I(M),P=k(M,"DIV",{class:!0,title:!0});var ye=E(P);_e=S(ye,"‚ùå "),me=S(ye,je),ye.forEach(g),M.forEach(g),Me.forEach(g),ve=I(ne),O=k(ne,"BUTTON",{class:!0,title:!0});var Be=E(O);ee=S(Be,H),Be.forEach(g),ne.forEach(g),ge=I(j),W=k(j,"A",{href:!0});var Te=E(W);G=k(Te,"DIV",{});var De=E(G);te=S(De,J),le=S(De,Q),De.forEach(g),Te.forEach(g),j.forEach(g),this.h()},h(){m(f,"class","m-auto"),m(f,"title","Time since last attempt ("+Oe(a[4].date,!1)+")"),m(_,"class","m-auto"),m(_,"title","Duration of last attempt ("+a[4].duration+" minutes)"),m(u,"class","m-auto"),m(u,"title","Number of attempts"),m(y,"class","m-auto"),m(y,"title","Number of unresolved questions"),m(P,"class","m-auto"),m(P,"title","Weighted average of incorrect problems"),m(s,"class","w-full aspect-square border m-auto grid grid-cols-2 grid-rows-3"),m(t,"href",a[3]),m(O,"class","attempt-dropdown svelte-wqw3oy"),m(O,"title","Show attempts"),m(l,"class","relative"),m(W,"href",a[3]),m(e,"class","text-center w-[6rem] mr-[11px]")},m(L,j){T(L,e,j),d(e,l),d(l,t),d(t,s),d(s,f),d(f,r),d(f,n),d(s,c),d(s,_),d(_,p),d(_,i),d(s,h),d(s,u),d(u,B),d(u,w),d(s,C),d(s,A),d(s,y),d(y,K),d(y,x),d(s,de),d(s,P),d(P,_e),d(P,me),d(l,ve),d(l,O),d(O,ee),d(e,ge),d(e,W),d(W,G),d(G,te),d(G,le),pe||(Ce=Ve(O,"click",function(){He(a[5].bind(this,a[0].id))&&a[5].bind(this,a[0].id).apply(this,arguments)}),pe=!0)},p(L,[j]){a=L,j&1&&q!==(q=a[0].attempts.length+"")&&N(w,q),j&1&&F!==(F=a[0].attempts.reduce(ze,0)+"")&&N(x,F),j&4&&H!==(H=a[2]?"üóëÔ∏è":"üîª")&&N(ee,H),j&1&&J!==(J=a[0].flagged?new Date().getMonth()===5?"üè≥Ô∏è‚Äçüåà ":"üö© ":"")&&N(te,J),j&1&&Q!==(Q=a[0].name+"")&&N(le,Q)},i:X,o:X,d(L){L&&g(e),pe=!1,Ce()}}}function Oe(a,e=!0){const l=new Date,t=(l.getTime()-a.getTime())/(1e3*60*60*24);if(t<=10)return Math.floor(t)+(e?"d":" days");const s=t/7;if(s<=16)return Math.floor(s)+(e?"w":" weeks");const r=(l.getFullYear()-a.getFullYear())*12+(l.getMonth()-a.getMonth());return r<12?r+(e?"m":" months"):Math.floor(r/12)+(e?"y":" years")}const ze=(a,e)=>a+=e.questionCount;function rt(a,e,l){let t,s=X,f=()=>(s(),s=$e(n,v=>l(2,t=v)),n),r;ae(a,Ae,v=>l(6,r=v)),a.$$.on_destroy.push(()=>s());let{file:o}=e,{deleteEnabled:n}=e;f();const c=Y.join("/",Z,r.params.path,o.id.toString()),_=function(v){return v.attempts.length===0?Ze.newBlankAttempt():v.attempts.reduce((i,h)=>h.date>i.date?h:i)}(o);function p(v){t&&R.files.delete(v)}return a.$$set=v=>{"file"in v&&l(0,o=v.file),"deleteEnabled"in v&&f(l(1,n=v.deleteEnabled))},[o,n,t,c,_,p]}class it extends ce{constructor(e){super(),he(this,e,rt,st,ue,{file:0,deleteEnabled:1})}}function ot(a,e,l){const t=a.slice();return t[6]=e[l],t}function Le(a,e,l){const t=a.slice();return t[9]=e[l],t}function Ne(a,e,l){const t=a.slice();return t[12]=e[l],t}function Ue(a){let e,l,t="üìÅ",s,f=a[12]+"",r,o;return{c(){e=b("a"),l=b("div"),l.textContent=t,s=V(),r=D(f),this.h()},l(n){e=k(n,"A",{href:!0,class:!0});var c=E(e);l=k(c,"DIV",{class:!0,"data-svelte-h":!0}),Ie(l)!=="svelte-4573lq"&&(l.textContent=t),s=I(c),r=S(c,f),c.forEach(g),this.h()},h(){m(l,"class","text-7xl aspect-square perfect-center font-mono"),m(e,"href",o=Y.join("/",Z,a[2].params.path,a[12])),m(e,"class","text-center w-[6rem]")},m(n,c){T(n,e,c),d(e,l),d(e,s),d(e,r)},p(n,c){c&2&&f!==(f=n[12]+"")&&N(r,f),c&6&&o!==(o=Y.join("/",Z,n[2].params.path,n[12]))&&m(e,"href",o)},d(n){n&&g(e)}}}function Ye(a,e){let l,t,s;return t=new it({props:{file:e[9],deleteEnabled:e[0]}}),{key:a,first:null,c(){l=se(),re(t.$$.fragment),this.h()},l(f){l=se(),ie(t.$$.fragment,f),this.h()},h(){this.first=l},m(f,r){T(f,l,r),oe(t,f,r),s=!0},p(f,r){e=f;const o={};r&16&&(o.file=e[9]),r&1&&(o.deleteEnabled=e[0]),t.$set(o)},i(f){s||(z(t.$$.fragment,f),s=!0)},o(f){$(t.$$.fragment,f),s=!1},d(f){f&&g(l),fe(t,f)}}}function ft(a){let e;return{c(){e=b("div"),this.h()},l(l){e=k(l,"DIV",{class:!0}),E(e).forEach(g),this.h()},h(){m(e,"class","w-[6rem] mr-[11px]")},m(l,t){T(l,e,t)},p:X,d(l){l&&g(e)}}}function ut(a){let e,l,t=[],s=new Map,f,r,o=U(Object.keys(a[1])),n=[];for(let i=0;i<o.length;i+=1)n[i]=Ue(Ne(a,o,i));let c=U(a[4]??[]);const _=i=>i[9].id;for(let i=0;i<c.length;i+=1){let h=Le(a,c,i),u=_(h);s.set(u,t[i]=Ye(u,h))}let p=U(Array(10)),v=[];for(let i=0;i<p.length;i+=1)v[i]=ft(ot(a,p,i));return{c(){e=b("div");for(let i=0;i<n.length;i+=1)n[i].c();l=V();for(let i=0;i<t.length;i+=1)t[i].c();f=V();for(let i=0;i<v.length;i+=1)v[i].c();this.h()},l(i){e=k(i,"DIV",{class:!0});var h=E(e);for(let u=0;u<n.length;u+=1)n[u].l(h);l=I(h);for(let u=0;u<t.length;u+=1)t[u].l(h);f=I(h);for(let u=0;u<v.length;u+=1)v[u].l(h);h.forEach(g),this.h()},h(){m(e,"class","flex flex-wrap justify-evenly gap-3")},m(i,h){T(i,e,h);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(e,null);d(e,l);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);d(e,f);for(let u=0;u<v.length;u+=1)v[u]&&v[u].m(e,null);r=!0},p(i,[h]){if(h&6){o=U(Object.keys(i[1]));let u;for(u=0;u<o.length;u+=1){const B=Ne(i,o,u);n[u]?n[u].p(B,h):(n[u]=Ue(B),n[u].c(),n[u].m(e,l))}for(;u<n.length;u+=1)n[u].d(1);n.length=o.length}h&17&&(c=U(i[4]??[]),Ke(),t=et(t,h,_,1,i,c,s,e,tt,Ye,f,Le),We())},i(i){if(!r){for(let h=0;h<c.length;h+=1)z(t[h]);r=!0}},o(i){for(let h=0;h<t.length;h+=1)$(t[h]);r=!1},d(i){i&&g(e),Se(n,i);for(let h=0;h<t.length;h+=1)t[h].d();Se(v,i)}}}function ct(a,e,l){let t,s,f=X,r=()=>(f(),f=$e(_,p=>l(4,s=p)),_);ae(a,Ae,p=>l(2,t=p)),a.$$.on_destroy.push(()=>f());let{fileStruct:o}=e,{deleteEnabled:n}=e,c={},_;return a.$$set=p=>{"fileStruct"in p&&l(5,o=p.fileStruct),"deleteEnabled"in p&&l(0,n=p.deleteEnabled)},a.$$.update=()=>{if(a.$$.dirty&38){l(1,c=o);for(const p of t.data.path)if(l(1,c=c[p]),c==null){l(1,c={});break}}a.$$.dirty&4&&r(l(3,_=xe(()=>R.files.where({route:t.params.path}).toArray())))},[n,c,t,_,s,o]}class ht extends ce{constructor(e){super(),he(this,e,ct,ut,ue,{fileStruct:5,deleteEnabled:0})}}function dt(a){let e,l,t,s,f="üóëÔ∏è file",r,o,n="‚ûï file",c,_,p,v,i,h,u,B,q;return p=new Ge({props:{fileStruct:a[0]}}),h=new ht({props:{fileStruct:a[0],deleteEnabled:a[3]}}),{c(){e=V(),l=b("div"),t=b("div"),s=b("button"),s.textContent=f,r=V(),o=b("button"),o.textContent=n,c=V(),_=b("div"),re(p.$$.fragment),v=V(),i=b("div"),re(h.$$.fragment),this.h()},l(w){Xe("svelte-8s10wx",document.head).forEach(g),e=I(w),l=k(w,"DIV",{id:!0,class:!0});var A=E(l);t=k(A,"DIV",{id:!0,class:!0});var y=E(t);s=k(y,"BUTTON",{"data-svelte-h":!0}),Ie(s)!=="svelte-1e4eght"&&(s.textContent=f),r=I(y),o=k(y,"BUTTON",{"data-svelte-h":!0}),Ie(o)!=="svelte-9lzaak"&&(o.textContent=n),y.forEach(g),c=I(A),_=k(A,"DIV",{id:!0,class:!0});var K=E(_);ie(p.$$.fragment,K),K.forEach(g),v=I(A),i=k(A,"DIV",{id:!0,class:!0});var F=E(i);ie(h.$$.fragment,F),F.forEach(g),A.forEach(g),this.h()},h(){document.title="MathMan Browse",m(t,"id","ribbon"),m(t,"class","text-right svelte-1huhyzt"),m(_,"id","folders"),m(_,"class","svelte-1huhyzt"),m(i,"id","files"),m(i,"class","svelte-1huhyzt"),m(l,"id","grid"),m(l,"class","svelte-1huhyzt")},m(w,C){T(w,e,C),T(w,l,C),d(l,t),d(t,s),d(t,r),d(t,o),d(l,c),d(l,_),oe(p,_,null),d(l,v),d(l,i),oe(h,i,null),u=!0,B||(q=[Ve(s,"click",a[4]),Ve(o,"click",a[5])],B=!0)},p(w,[C]){const A={};C&1&&(A.fileStruct=w[0]),p.$set(A);const y={};C&1&&(y.fileStruct=w[0]),h.$set(y)},i(w){u||(z(p.$$.fragment,w),z(h.$$.fragment,w),u=!0)},o(w){$(p.$$.fragment,w),$(h.$$.fragment,w),u=!1},d(w){w&&(g(e),g(l)),fe(p),fe(h),B=!1,Je(q)}}}function _t(a,e,l){let t,s;ae(a,Ae,_=>l(2,s=_));let f={};const r=lt(!1);ae(a,r,_=>l(1,t=_));async function o(){const _={"":{}},p=await R.files.orderBy("route").uniqueKeys();for(const v of p){let i=_[""];for(const h of v.split("/"))h in i||(i[h]={}),i=i[h]}return _}return Qe(()=>{window.db=R,o().then(_=>l(0,f=_))}),[f,t,s,r,()=>Re(r,t=!t,t),()=>R.newFile({basePath:s.params.path})]}class wt extends ce{constructor(e){super(),he(this,e,_t,dt,ue,{})}}export{wt as component};
