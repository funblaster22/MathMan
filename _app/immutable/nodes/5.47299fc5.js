import{s as $,n as z,f as ue,e as K,m as Qe,k as ye,o as Se,j as Ne,b as oe,p as Re,r as Oe}from"../chunks/scheduler.8f0c50f0.js";import{S as ee,i as te,s as O,g as y,c as P,h as S,C as ie,k as b,l as R,a as M,A as F,D as Ae,f as _,j as L,x as A,r as j,m as Z,u as Y,n as x,v as G,d as H,t as B,w as X,E as ge,o as ce,y as qe,F as me,G as Pe,p as ze,b as Ue,B as We}from"../chunks/index.618bd48e.js";import{e as ne,u as Le,d as He,o as Be}from"../chunks/each.6c4e4e8a.js";import{j as Fe,w as _e,k as be}from"../chunks/singletons.eacabfe7.js";import{a as de,d as J,u as Ve,D as je,b as pe}from"../chunks/db.f41d9ada.js";import{p as ae}from"../chunks/stores.f453de5f.js";var V=(n=>(n[n.Draw=0]="Draw",n[n.Correct=1]="Correct",n[n.Question=2]="Question",n[n.None=3]="None",n[n.Select=4]="Select",n))(V||{});const Ye=""+new URL("../assets/eraser.0e084288.png",import.meta.url).href;function we(n){let e,t="Show Solution";return{c(){e=y("button"),e.textContent=t,this.h()},l(r){e=S(r,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-on8fyx"&&(e.textContent=t),this.h()},h(){b(e,"class","border text-center"),R(e,"position","fixed"),R(e,"left",n[1][0]+"px"),R(e,"top",n[1][1]+"px"),R(e,"width",n[2][0]-n[1][0]+"px"),R(e,"height",n[2][1]-n[1][1]+"px")},m(r,l){M(r,e,l)},p(r,l){l&2&&R(e,"left",r[1][0]+"px"),l&2&&R(e,"top",r[1][1]+"px"),l&6&&R(e,"width",r[2][0]-r[1][0]+"px"),l&6&&R(e,"height",r[2][1]-r[1][1]+"px")},d(r){r&&_(e)}}}function Ge(n){let e,t,r='<div style="background-color: green">‚úÖ</div>',l,i,o=n[1][1]&&we(n);return{c(){o&&o.c(),e=O(),t=y("div"),t.innerHTML=r,this.h()},l(a){o&&o.l(a),e=P(a),t=S(a,"DIV",{class:!0,"data-svelte-h":!0}),ie(t)!=="svelte-aiv1v7"&&(t.innerHTML=r),this.h()},h(){b(t,"class","tool"),R(t,"height",n[0]?"100%":"30px")},m(a,s){o&&o.m(a,s),M(a,e,s),M(a,t,s),l||(i=F(t,"pointerdown",Ae(n[8])),l=!0)},p(a,[s]){a[1][1]?o?o.p(a,s):(o=we(a),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),s&1&&R(t,"height",a[0]?"100%":"30px")},i:z,o:z,d(a){a&&(_(e),_(t)),o&&o.d(a),l=!1,i()}}}function Xe(n,e,t){let r;const l=V.Select;let i=!1,o=!1,a=[],s=[],c,h,m=ue("selection");K(n,m,I=>t(7,r=I)),window.addEventListener("pointerdown",I=>{i&&(o=!0,t(5,a=t(6,s=[I.x,I.y])))}),window.addEventListener("pointermove",I=>{o&&t(6,s=[I.x,I.y])}),window.addEventListener("pointerup",()=>{o=!1});const f=()=>m.set(i?V.None:l);return n.$$.update=()=>{n.$$.dirty&128&&t(0,i=r===l),n.$$.dirty&96&&(t(1,c=[Math.min(a[0],s[0]),Math.min(a[1],s[1])]),t(2,h=[Math.max(a[0],s[0]),Math.max(a[1],s[1])]))},[i,c,h,l,m,a,s,r,f]}class Je extends ee{constructor(e){super(),te(this,e,Xe,Ge,$,{})}}const Ke=""+new URL("../assets/marker.c9b3b178.png",import.meta.url).href;function Ze(n){let e,t,r,l,i;return{c(){e=y("div"),t=y("img"),this.h()},l(o){e=S(o,"DIV",{class:!0});var a=L(e);t=S(a,"IMG",{style:!0,src:!0,title:!0,draggable:!0}),a.forEach(_),this.h()},h(){R(t,"filter",n[1]),Qe(t.src,r=Ke)||b(t,"src",r),b(t,"title",n[2]),b(t,"draggable","false"),b(e,"class","tool"),R(e,"height",n[3]?"100%":"30px")},m(o,a){M(o,e,a),A(e,t),l||(i=F(e,"pointerdown",Ae(n[6])),l=!0)},p(o,[a]){a&2&&R(t,"filter",o[1]),a&4&&b(t,"title",o[2]),a&8&&R(e,"height",o[3]?"100%":"30px")},i:z,o:z,d(o){o&&_(e),l=!1,i()}}}function xe(n,e,t){let r,{tool:l}=e,{filter:i=""}=e,{title:o}=e,a=ue("selection");K(n,a,h=>t(5,r=h));let s=!1;const c=()=>a.set(s?V.None:l);return n.$$set=h=>{"tool"in h&&t(0,l=h.tool),"filter"in h&&t(1,i=h.filter),"title"in h&&t(2,o=h.title)},n.$$.update=()=>{n.$$.dirty&33&&t(3,s=r===l)},[l,i,o,s,a,r,c]}class he extends ee{constructor(e){super(),te(this,e,xe,Ze,$,{tool:0,filter:1,title:2})}}function $e(n){let e,t,r,l,i,o,a,s,c,h,m,f,I,T,D=`<img src="${Ye}" title="Eraser" draggable="false" class="svelte-h3rgmi"/>`,E,C,w;return t=new Je({}),s=new he({props:{tool:V.Draw,filter:"grayscale(1)",title:"Your work"}}),h=new he({props:{tool:V.Correct,filter:"hue-rotate(136deg)",title:"Correct"}}),f=new he({props:{tool:V.Question,title:"Question"}}),{c(){e=y("div"),j(t.$$.fragment),r=O(),l=y("a"),i=Z("üì∑"),a=O(),j(s.$$.fragment),c=O(),j(h.$$.fragment),m=O(),j(f.$$.fragment),I=O(),T=y("div"),T.innerHTML=D,this.h()},l(p){e=S(p,"DIV",{id:!0,class:!0});var u=L(e);Y(t.$$.fragment,u),r=P(u),l=S(u,"A",{href:!0});var v=L(l);i=x(v,"üì∑"),v.forEach(_),a=P(u),Y(s.$$.fragment,u),c=P(u),Y(h.$$.fragment,u),m=P(u),Y(f.$$.fragment,u),I=P(u),T=S(u,"DIV",{class:!0,"data-svelte-h":!0}),ie(T)!=="svelte-19p7wft"&&(T.innerHTML=D),u.forEach(_),this.h()},h(){b(l,"href",o=de("camera",n[1].params.problemId)),b(T,"class","tool"),R(T,"height",n[0]?"100%":"30px"),b(e,"id","tools"),b(e,"class","svelte-h3rgmi")},m(p,u){M(p,e,u),G(t,e,null),A(e,r),A(e,l),A(l,i),A(e,a),G(s,e,null),A(e,c),G(h,e,null),A(e,m),G(f,e,null),A(e,I),A(e,T),E=!0,C||(w=F(T,"click",n[3]),C=!0)},p(p,[u]){(!E||u&2&&o!==(o=de("camera",p[1].params.problemId)))&&b(l,"href",o),u&1&&R(T,"height",p[0]?"100%":"30px")},i(p){E||(H(t.$$.fragment,p),H(s.$$.fragment,p),H(h.$$.fragment,p),H(f.$$.fragment,p),E=!0)},o(p){B(t.$$.fragment,p),B(s.$$.fragment,p),B(h.$$.fragment,p),B(f.$$.fragment,p),E=!1},d(p){p&&_(e),X(t),X(s),X(h),X(f),C=!1,w()}}}function et(n,e,t){let r,l;K(n,ae,s=>t(1,l=s));let{selected:i}=e;ye("selection",i);let o=ue("eraserEnabled");K(n,o,s=>t(0,r=s));function a(s){o.set(!r)}return n.$$set=s=>{"selected"in s&&t(4,i=s.selected)},[r,l,o,a,i]}class tt extends ee{constructor(e){super(),te(this,e,et,$e,$,{selected:4})}}function nt(n){let e,t,r,l,i,o,a;return{c(){e=y("canvas"),t=O(),r=y("canvas"),l=O(),i=y("canvas"),this.h()},l(s){e=S(s,"CANVAS",{width:!0,height:!0,class:!0}),L(e).forEach(_),t=P(s),r=S(s,"CANVAS",{width:!0,height:!0,class:!0}),L(r).forEach(_),l=P(s),i=S(s,"CANVAS",{width:!0,height:!0,class:!0}),L(i).forEach(_),this.h()},h(){b(e,"width",n[2]),b(e,"height",n[3]),b(e,"class","svelte-1rofrvo"),b(r,"width",n[2]),b(r,"height",n[3]),b(r,"class","svelte-1rofrvo"),b(i,"width",n[2]),b(i,"height",n[3]),b(i,"class","svelte-1rofrvo")},m(s,c){M(s,e,c),n[8](e),M(s,t,c),M(s,r,c),n[9](r),M(s,l,c),M(s,i,c),n[10](i),o||(a=F(i,"pointerdown",n[5]),o=!0)},p(s,[c]){c&4&&b(e,"width",s[2]),c&8&&b(e,"height",s[3]),c&4&&b(r,"width",s[2]),c&8&&b(r,"height",s[3]),c&4&&b(i,"width",s[2]),c&8&&b(i,"height",s[3])},i:z,o:z,d(s){s&&(_(e),_(t),_(r),_(l),_(i)),n[8](null),n[9](null),n[10](null),o=!1,a()}}}function st(n,e,t){let r,l=z,i=()=>(l(),l=Ne(a,g=>t(13,r=g)),a),o;n.$$.on_destroy.push(()=>l());let{selectedTool:a}=e;i();let{problemId:s}=e,{attemptId:c}=e,h=0,m=0,f=!1,I=ue("eraserEnabled");K(n,I,g=>t(14,o=g));let T,D=[];function E(){typeof window>"u"||s===0||(t(2,h=window.innerWidth),t(3,m=window.innerHeight),requestAnimationFrame(async()=>{if(D[0]==null)return;const g=(await J.files.get(s)).attempts[c];D[V.Draw].putImageData(g.work,0,0),D[V.Correct].putImageData(g.error,0,0),D[V.Question].putImageData(g.questions,0,0)}))}const C=()=>{const g=[0,0,h,m];J.files.update(s,q=>{const W=q.attempts[c];W.date=new Date,W.duration=Math.floor((new Date().getTime()-T)/1e3/60),r==V.Correct&&(W.mistakeCount=1),r==V.Question&&(W.questionCount=1),W[["work","error","questions"][r]]=D[r].getImageData(...g)})},w=typeof window>"u"?!1:window.matchMedia("(prefers-color-scheme: dark)").matches,p={[V.Draw]:w?"white":"black",[V.Correct]:"red",[V.Question]:"blue"},u=g=>{if(r>=V.None)return;const q=D[r];f=!0,q.strokeStyle=p[r],q.lineWidth=o?20:1,q.globalCompositeOperation=o?"destination-out":"source-over",q.beginPath(),q.moveTo(g.clientX,g.clientY)},v=()=>{f&&C(),f=!1},k=g=>{if(f){const q=D[r];q.lineTo(g.clientX,g.clientY),q.stroke()}};Se(()=>{window.addEventListener("resize",E),document.addEventListener("pointermove",k),document.addEventListener("pointerup",v),t(1,D=D.map(g=>g.getContext("2d",{willReadFrequently:!0})))});function N(g){oe[g?"unshift":"push"](()=>{D[V.Draw]=g,t(1,D)})}function d(g){oe[g?"unshift":"push"](()=>{D[V.Correct]=g,t(1,D)})}function Q(g){oe[g?"unshift":"push"](()=>{D[V.Question]=g,t(1,D)})}return n.$$set=g=>{"selectedTool"in g&&i(t(0,a=g.selectedTool)),"problemId"in g&&t(6,s=g.problemId),"attemptId"in g&&t(7,c=g.attemptId)},n.$$.update=()=>{if(n.$$.dirty&194){E(),T=new Date().getTime();for(const g of D){const q=g.canvas;g.clearRect(0,0,q.width,q.height)}}},[a,D,h,m,I,u,s,c,N,d,Q]}class rt extends ee{constructor(e){super(),te(this,e,st,nt,$,{selectedTool:0,problemId:6,attemptId:7})}}const se=Fe("goto");function lt(n,e){const t=new URLSearchParams(location.search);return t.set(n,e),se("?"+t.toString())}function ve(n,e,t){const r=n.slice();return r[15]=e[t],r[17]=t,r}function ke(n,e,t){const r=n.slice();return r[18]=e[t],r}function Ie(n){let e,t=n[4][n[18]]+"",r;return{c(){e=y("option"),r=Z(t),this.h()},l(l){e=S(l,"OPTION",{});var i=L(e);r=x(i,t),i.forEach(_),this.h()},h(){e.__value=n[18],me(e,e.__value)},m(l,i){M(l,e,i),A(e,r)},p:z,d(l){l&&_(e)}}}function Ce(n,e){let t,r=e[15].name+"",l,i,o;return{key:n,first:null,c(){t=y("option"),l=Z(r),this.h()},l(a){t=S(a,"OPTION",{});var s=L(t);l=x(s,r),s.forEach(_),this.h()},h(){t.__value=i=e[17],me(t,t.__value),t.selected=o=e[15].id===e[0],this.first=t},m(a,s){M(a,t,s),A(t,l)},p(a,s){e=a,s&4&&r!==(r=e[15].name+"")&&ce(l,r),s&4&&i!==(i=e[17])&&(t.__value=i,me(t,t.__value)),s&5&&o!==(o=e[15].id===e[0])&&(t.selected=o)},d(a){a&&_(t)}}}function ot(n){let e,t=n[3]?new Date().getMonth()===5?"üè≥Ô∏è‚Äçüåà":"üö©":"üè≥Ô∏è",r,l,i,o,a,s,c=[],h=new Map,m,f,I="‚û°Ô∏è",T,D,E=ne(Object.keys(n[4])),C=[];for(let u=0;u<E.length;u+=1)C[u]=Ie(ke(n,E,u));let w=ne(n[2]);const p=u=>u[15].id;for(let u=0;u<w.length;u+=1){let v=ve(n,w,u),k=p(v);h.set(k,c[u]=Ce(k,v))}return{c(){e=y("button"),r=Z(t),i=O(),o=y("select");for(let u=0;u<C.length;u+=1)C[u].c();a=O(),s=y("select");for(let u=0;u<c.length;u+=1)c[u].c();m=O(),f=y("button"),f.textContent=I,this.h()},l(u){e=S(u,"BUTTON",{title:!0});var v=L(e);r=x(v,t),v.forEach(_),i=P(u),o=S(u,"SELECT",{});var k=L(o);for(let d=0;d<C.length;d+=1)C[d].l(k);k.forEach(_),a=P(u),s=S(u,"SELECT",{});var N=L(s);for(let d=0;d<c.length;d+=1)c[d].l(N);N.forEach(_),m=P(u),f=S(u,"BUTTON",{"data-svelte-h":!0}),ie(f)!=="svelte-1wjt799"&&(f.textContent=I),this.h()},h(){b(e,"title",l=(n[3]?"un":"")+"flag for later"),n[1]===void 0&&Re(()=>n[12].call(o))},m(u,v){M(u,e,v),A(e,r),M(u,i,v),M(u,o,v);for(let k=0;k<C.length;k+=1)C[k]&&C[k].m(o,null);ge(o,n[1],!0),M(u,a,v),M(u,s,v);for(let k=0;k<c.length;k+=1)c[k]&&c[k].m(s,null);M(u,m,v),M(u,f,v),T||(D=[F(e,"click",n[7]),F(o,"change",n[12]),F(s,"change",n[5]),F(f,"click",n[6])],T=!0)},p(u,[v]){if(v&8&&t!==(t=u[3]?new Date().getMonth()===5?"üè≥Ô∏è‚Äçüåà":"üö©":"üè≥Ô∏è")&&ce(r,t),v&8&&l!==(l=(u[3]?"un":"")+"flag for later")&&b(e,"title",l),v&16){E=ne(Object.keys(u[4]));let k;for(k=0;k<E.length;k+=1){const N=ke(u,E,k);C[k]?C[k].p(N,v):(C[k]=Ie(N),C[k].c(),C[k].m(o,null))}for(;k<C.length;k+=1)C[k].d(1);C.length=E.length}v&18&&ge(o,u[1]),v&5&&(w=ne(u[2]),c=Le(c,v,p,1,u,w,h,s,He,Ce,null,ve))},i:z,o:z,d(u){u&&(_(e),_(i),_(o),_(a),_(s),_(m),_(f)),qe(C,u);for(let v=0;v<c.length;v+=1)c[v].d();T=!1,Oe(D)}}}function at(n,e,t){let r,l;K(n,ae,w=>t(14,l=w));var i=(w=>(w.Work="Work",w.Mistakes="Mistakes",w.Questions="Questions",w))(i||{});let{problemRoute:o}=e,{problemId:a}=e,s=0,c=l.url.searchParams.get("studyMode")??"Work",h=!1,m;function f(w){t(10,s=Number.parseInt(w.target.value))}function I(){if(t(10,++s)>=E.length)if(c==="Work"){const w=Array.from(m.matchAll(/\d+/g)).at(-1);let p;w!=null&&(p=m.substring(0,w.index)+(Number.parseInt(w[0])+1)+m.substring(w.index+w[0].length)),J.newFile({basePath:l.params.path,route:p}).then(u=>{u>=0&&se(String(u))})}else alert("Hooray! You are done!"),t(10,s--,s)}function T(){t(3,h=!h),J.files.update(a,{flagged:h})}const D=Ve(()=>J.files.where("route").startsWith(l.params.path).toArray().then(w=>w.map(p=>({id:p.id,route:p.route,name:p.name,attempts:p.attempts.map(u=>({questions:u.questionCount,mistakes:u.mistakeCount}))}))));K(n,D,w=>t(11,r=w));let E=[];function C(){c=Pe(this),t(1,c),t(4,i)}return n.$$set=w=>{"problemRoute"in w&&t(9,o=w.problemRoute),"problemId"in w&&t(0,a=w.problemId)},n.$$.update=()=>{var w;if(n.$$.dirty&2562){const p=r??[];switch(c){case"Work":t(2,E=p.filter(u=>u.route===o).sort((u,v)=>u.name.localeCompare(v.name)));break;case"Mistakes":t(2,E=p.filter(u=>u.attempts.at(-1).mistakes>0));break;case"Questions":t(2,E=p.filter(u=>u.attempts.some(v=>v.questions>0)));break}}if(n.$$.dirty&5&&t(10,s=Math.max(0,E.findIndex(p=>p.id===a))),n.$$.dirty&1028){const p=(w=E[s])==null?void 0:w.id;p&&se(String(p))}n.$$.dirty&1&&J.files.get(a).then(p=>{t(3,h=(p==null?void 0:p.flagged)??!1),m=(p==null?void 0:p.name)??""})},[a,c,E,h,i,f,I,T,D,o,s,r,C]}class it extends ee{constructor(e){super(),te(this,e,at,ot,$,{problemRoute:9,problemId:0})}}function ut(n){let e,t,r,l,i=n[0]+1+"",o;return{c(){e=y("div"),t=y("canvas"),l=Z(`
    Attempt `),o=Z(i),this.h()},l(a){e=S(a,"DIV",{class:!0});var s=L(e);t=S(s,"CANVAS",{width:!0,height:!0}),L(t).forEach(_),l=x(s,`
    Attempt `),o=x(s,i),s.forEach(_),this.h()},h(){b(t,"width",n[1]),b(t,"height",r=n[1]-24),b(e,"class","text-center bg-gray-50 rounded-md"),R(e,"width",n[1]+"px")},m(a,s){M(a,e,s),A(e,t),n[4](t),A(e,l),A(e,o)},p(a,[s]){s&2&&b(t,"width",a[1]),s&2&&r!==(r=a[1]-24)&&b(t,"height",r),s&1&&i!==(i=a[0]+1+"")&&ce(o,i),s&2&&R(e,"width",a[1]+"px")},i:z,o:z,d(a){a&&_(e),n[4](null)}}}function ct(n,e,t){let{attempt:r}=e,{idx:l}=e,{size:i=100}=e,o;function a(c,h){const m=document.createElement("canvas");m.width=h[0].width,m.height=h[0].height,c.scale(i/m.width,(i-24)/m.height);for(const f of h)m.getContext("2d").putImageData(f,0,0),c.drawImage(m,0,0)}Se(async()=>{const c=o.getContext("2d");a(c,[r.work,r.error,r.questions])});function s(c){oe[c?"unshift":"push"](()=>{o=c,t(2,o)})}return n.$$set=c=>{"attempt"in c&&t(3,r=c.attempt),"idx"in c&&t(0,l=c.idx),"size"in c&&t(1,i=c.size)},[l,i,o,r,s]}class ft extends ee{constructor(e){super(),te(this,e,ct,ut,$,{attempt:3,idx:0,size:1})}}function Ee(n,e,t){const r=n.slice();return r[5]=e[t],r[7]=t,r}function De(n,e){let t,r,l,i,o;r=new ft({props:{attempt:e[5],idx:e[7]}});function a(){return e[4](e[7])}return{key:n,first:null,c(){t=y("button"),j(r.$$.fragment),this.h()},l(s){t=S(s,"BUTTON",{});var c=L(t);Y(r.$$.fragment,c),c.forEach(_),this.h()},h(){this.first=t},m(s,c){M(s,t,c),G(r,t,null),l=!0,i||(o=F(t,"click",a),i=!0)},p(s,c){e=s;const h={};c&4&&(h.attempt=e[5]),c&4&&(h.idx=e[7]),r.$set(h)},i(s){l||(H(r.$$.fragment,s),l=!0)},o(s){B(r.$$.fragment,s),l=!1},d(s){s&&_(t),X(r),i=!1,o()}}}function ht(n){let e=[],t=new Map,r,l,i=`<div class="w-[100px] h-[76px] align-middle text-5xl leading-[1.65]">‚ûï</div>
    New Attempt`,o,a,s,c=ne(n[2]??[]);const h=m=>""+m[0]+m[7];for(let m=0;m<c.length;m+=1){let f=Ee(n,c,m),I=h(f);t.set(I,e[m]=De(I,f))}return{c(){for(let m=0;m<e.length;m+=1)e[m].c();r=O(),l=y("button"),l.innerHTML=i,this.h()},l(m){for(let f=0;f<e.length;f+=1)e[f].l(m);r=P(m),l=S(m,"BUTTON",{class:!0,"data-svelte-h":!0}),ie(l)!=="svelte-1goxpwn"&&(l.innerHTML=i),this.h()},h(){b(l,"class","text-center bg-gray-50 rounded-md w-[100px]")},m(m,f){for(let I=0;I<e.length;I+=1)e[I]&&e[I].m(m,f);M(m,r,f),M(m,l,f),o=!0,a||(s=F(l,"click",n[3]),a=!0)},p(m,[f]){f&5&&(c=ne(m[2]??[]),ze(),e=Le(e,f,h,1,m,c,t,r.parentNode,Be,De,r,Ee),Ue())},i(m){if(!o){for(let f=0;f<c.length;f+=1)H(e[f]);o=!0}},o(m){for(let f=0;f<e.length;f+=1)B(e[f]);o=!1},d(m){m&&(_(r),_(l));for(let f=0;f<e.length;f+=1)e[f].d(m);a=!1,s()}}}function mt(n,e,t){let r,l=z,i=()=>(l(),l=Ne(a,h=>t(2,r=h)),a);n.$$.on_destroy.push(()=>l());let{problemId:o}=e,a;function s(){J.files.update(o,h=>{se("?attempt="+h.attempts.push(je.newBlankAttempt()))})}const c=h=>lt("attempt",String(h+1));return n.$$set=h=>{"problemId"in h&&t(0,o=h.problemId)},n.$$.update=()=>{n.$$.dirty&1&&i(t(1,a=Ve(()=>J.files.get(o).then(h=>h.attempts))))},[o,a,r,s,c]}class dt extends ee{constructor(e){super(),te(this,e,mt,ht,$,{problemId:0})}}function pt(n){let e,t,r;return{c(){e=y("canvas"),this.h()},l(l){e=S(l,"CANVAS",{class:!0}),L(e).forEach(_),this.h()},h(){b(e,"class","fixed left-0 top-[2em]")},m(l,i){M(l,e,i),n[3](e),t||(r=F(e,"mousedown",n[1]),t=!0)},p:z,i:z,o:z,d(l){l&&_(e),n[3](null),t=!1,r()}}}function gt(n,e,t){let{problemId:r}=e,l,i;function o(s){setTimeout(()=>{i.dragStart(s)})}function a(s){oe[s?"unshift":"push"](()=>{l=s,t(0,l),t(2,r)})}return n.$$set=s=>{"problemId"in s&&t(2,r=s.problemId)},n.$$.update=()=>{n.$$.dirty&5&&J.files.get(r).then(s=>{s!=null&&s.question&&(t(0,l.width=s.question.width,l),t(0,l.height=s.question.height,l),l.getContext("2d").putImageData(s.question,0,0))})},[l,o,r,a]}class _t extends ee{constructor(e){super(),te(this,e,gt,pt,$,{problemId:2})}}function Me(n,e,t){const r=n.slice();return r[9]=e[t],r}function Te(n){let e,t=n[9]+"",r;return{c(){e=Z("/"),r=Z(t)},l(l){e=x(l,"/"),r=x(l,t)},m(l,i){M(l,e,i),M(l,r,i)},p(l,i){i&4&&t!==(t=l[9]+"")&&ce(r,t)},d(l){l&&(_(e),_(r))}}}function bt(n){let e,t,r,l,i,o,a,s,c,h,m,f,I,T,D,E,C,w,p,u,v;t=new _t({props:{problemId:n[0]}}),l=new rt({props:{selectedTool:n[4],problemId:n[0],attemptId:n[3]}});let k=ne(n[2].params.path.split("/")),N=[];for(let d=0;d<k.length;d+=1)N[d]=Te(Me(n,k,d));return T=new it({props:{problemId:n[0],problemRoute:n[1]}}),C=new tt({props:{selected:n[4]}}),u=new dt({props:{problemId:n[0]}}),{c(){e=O(),j(t.$$.fragment),r=O(),j(l.$$.fragment),i=O(),o=y("div"),a=y("div"),s=y("a"),c=Z("üè†"),m=O();for(let d=0;d<N.length;d+=1)N[d].c();f=O(),I=y("div"),j(T.$$.fragment),D=O(),E=y("div"),j(C.$$.fragment),w=O(),p=y("div"),j(u.$$.fragment),this.h()},l(d){We("svelte-pyemm1",document.head).forEach(_),e=P(d),Y(t.$$.fragment,d),r=P(d),Y(l.$$.fragment,d),i=P(d),o=S(d,"DIV",{id:!0,class:!0});var g=L(o);a=S(g,"DIV",{id:!0,class:!0});var q=L(a);s=S(q,"A",{href:!0});var W=L(s);c=x(W,"üè†"),W.forEach(_),m=P(q);for(let fe=0;fe<N.length;fe+=1)N[fe].l(q);q.forEach(_),f=P(g),I=S(g,"DIV",{id:!0,class:!0});var re=L(I);Y(T.$$.fragment,re),re.forEach(_),D=P(g),E=S(g,"DIV",{id:!0,class:!0});var U=L(E);Y(C.$$.fragment,U),U.forEach(_),w=P(g),p=S(g,"DIV",{id:!0,class:!0});var le=L(p);Y(u.$$.fragment,le),le.forEach(_),g.forEach(_),this.h()},h(){document.title="MathMan Draw",b(s,"href",h=pe(n[2])),b(a,"id","breadcrumbs"),b(a,"class","svelte-1edzgew"),b(I,"id","question-management"),b(I,"class","text-right svelte-1edzgew"),b(E,"id","tools-container"),b(E,"class","svelte-1edzgew"),b(p,"id","attempts-container"),b(p,"class","flex flex-col p-3 gap-3 svelte-1edzgew"),b(o,"id","grid"),b(o,"class","svelte-1edzgew")},m(d,Q){M(d,e,Q),G(t,d,Q),M(d,r,Q),G(l,d,Q),M(d,i,Q),M(d,o,Q),A(o,a),A(a,s),A(s,c),A(a,m);for(let g=0;g<N.length;g+=1)N[g]&&N[g].m(a,null);A(o,f),A(o,I),G(T,I,null),A(o,D),A(o,E),G(C,E,null),A(o,w),A(o,p),G(u,p,null),v=!0},p(d,[Q]){const g={};Q&1&&(g.problemId=d[0]),t.$set(g);const q={};if(Q&1&&(q.problemId=d[0]),Q&8&&(q.attemptId=d[3]),l.$set(q),(!v||Q&4&&h!==(h=pe(d[2])))&&b(s,"href",h),Q&4){k=ne(d[2].params.path.split("/"));let U;for(U=0;U<k.length;U+=1){const le=Me(d,k,U);N[U]?N[U].p(le,Q):(N[U]=Te(le),N[U].c(),N[U].m(a,null))}for(;U<N.length;U+=1)N[U].d(1);N.length=k.length}const W={};Q&1&&(W.problemId=d[0]),Q&2&&(W.problemRoute=d[1]),T.$set(W);const re={};Q&1&&(re.problemId=d[0]),u.$set(re)},i(d){v||(H(t.$$.fragment,d),H(l.$$.fragment,d),H(T.$$.fragment,d),H(C.$$.fragment,d),H(u.$$.fragment,d),v=!0)},o(d){B(t.$$.fragment,d),B(l.$$.fragment,d),B(T.$$.fragment,d),B(C.$$.fragment,d),B(u.$$.fragment,d),v=!1},d(d){d&&(_(e),_(r),_(i),_(o)),X(t,d),X(l,d),qe(N,d),X(T),X(C),X(u)}}}function wt(n,e,t){let r,l,i;K(n,ae,f=>t(2,l=f));const o=_e(V.None),a=_e(!1);ye("eraserEnabled",a);const s=be(ae,f=>f.data.problemId);K(n,s,f=>t(0,r=f));const c=be(ae,f=>Number.parseInt(f.url.searchParams.get("attempt")??"1")-1);K(n,c,f=>t(3,i=f));let h;function m(f){r!==0&&(f?(t(1,h=f.route),h.startsWith(l.params.path)||se(de(h,l.params.problemId))):se(pe(l)))}return n.$$.update=()=>{n.$$.dirty&1&&J.files.get(r).then(m)},[r,h,l,i,o,s,c]}class Mt extends ee{constructor(e){super(),te(this,e,wt,bt,$,{})}}export{Mt as component};
