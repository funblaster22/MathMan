import{s as B,n as I,b as M,q as H,e as T,o as W,v as $}from"../chunks/scheduler.d208cd37.js";import{S as O,i as q,g as _,h as g,j as b,f as d,k as x,l as D,a as z,x as k,A as C,H as A,s as V,r as N,c as j,u as P,v as R,d as S,t as U,w as F}from"../chunks/index.8c8d301a.js";import{d as X}from"../chunks/db.ddd98041.js";import{p as Y}from"../chunks/stores.f33617e2.js";function G(c){let t,o,r,n;return{c(){t=_("div"),o=_("div"),this.h()},l(e){t=g(e,"DIV",{class:!0});var i=b(t);o=g(i,"DIV",{class:!0}),b(o).forEach(d),i.forEach(d),this.h()},h(){x(o,"class","absolute right-0 bottom-0 w-5 h-5 bg-red-50 cursor-nw-resize svelte-1o3tvyk"),x(t,"class","relative overflow-auto border min-w-12 min-h-12 svelte-1o3tvyk"),D(t,"width",c[0][0]+"px"),D(t,"height",c[0][1]+"px")},m(e,i){z(e,t,i),k(t,o),r||(n=C(o,"pointerdown",c[1]),r=!0)},p(e,[i]){i&1&&D(t,"width",e[0][0]+"px"),i&1&&D(t,"height",e[0][1]+"px")},i:I,o:I,d(e){e&&d(t),r=!1,n()}}}function J(){document.onpointermove=document.onpointerup=null}function K(c,t,o){let{size:r=[170,70]}=t;function n(){document.onpointermove=e,document.onpointerup=J}function e(i){o(0,r[0]+=i.movementX,r),o(0,r[1]+=i.movementY,r)}return c.$$set=i=>{"size"in i&&o(0,r=i.size)},[r,n]}class L extends O{constructor(t){super(),q(this,t,K,G,B,{size:0})}}function Q(c){let t,o,r,n,e,i,w,u,m,a,h,f;function p(s){c[4](s)}let y={};return c[1]!==void 0&&(y.size=c[1]),e=new L({props:y}),M.push(()=>A(e,"size",p)),{c(){t=_("div"),o=_("video"),r=V(),n=_("div"),N(e.$$.fragment),w=V(),u=_("div"),m=_("button"),this.h()},l(s){t=g(s,"DIV",{class:!0});var l=b(t);o=g(l,"VIDEO",{class:!0}),b(o).forEach(d),l.forEach(d),r=j(s),n=g(s,"DIV",{class:!0});var v=b(n);P(e.$$.fragment,v),v.forEach(d),w=j(s),u=g(s,"DIV",{class:!0});var E=b(u);m=g(E,"BUTTON",{class:!0}),b(m).forEach(d),E.forEach(d),this.h()},h(){x(o,"class","w-full"),x(t,"class","fixed inset-x-0 inset-y-0"),x(n,"class","fixed w-full h-[60vh] inset-x-0 top-0 flex items-center justify-center"),x(m,"class","rounded-full bg-red-500 m-auto block w-12 h-12"),x(u,"class","fixed inset-x-0 bottom-12")},m(s,l){z(s,t,l),k(t,o),c[3](o),z(s,r,l),z(s,n,l),R(e,n,null),z(s,w,l),z(s,u,l),k(u,m),a=!0,h||(f=C(m,"click",c[2]),h=!0)},p(s,[l]){const v={};!i&&l&2&&(i=!0,v.size=s[1],H(()=>i=!1)),e.$set(v)},i(s){a||(S(e.$$.fragment,s),a=!0)},o(s){U(e.$$.fragment,s),a=!1},d(s){s&&(d(t),d(r),d(n),d(w),d(u)),c[3](null),F(e),h=!1,f()}}}function Z(c,t,o){let r;T(c,Y,a=>o(5,r=a));let n,e;W(()=>{navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(a=>{o(0,n.srcObject=a,n),n.play()}).catch(a=>{console.error(`An error occurred: ${a}`)})}),$(()=>{n.srcObject.getVideoTracks()[0].stop()});function i(a){const[h,f]=[n.videoWidth,n.videoHeight],p=document.createElement("canvas");p.width=h,p.height=f;const y=p.getContext("2d");y.drawImage(n,0,0,h,f);const s=w(),l=h/window.innerWidth,v=y.getImageData(s.x*l,s.y*l,s.width*l,s.height*l);X.files.update(Number.parseInt(r.params.problemId),{question:v}).then(()=>history.back())}function w(){const{clientWidth:a,clientHeight:h}=document.documentElement,f=a/2,p=h*.3;return{x:Math.round(f-e[0]/2),y:Math.round(p-e[1]/2),width:e[0],height:e[1]}}function u(a){M[a?"unshift":"push"](()=>{n=a,o(0,n)})}function m(a){e=a,o(1,e)}return[n,e,i,u,m]}class oe extends O{constructor(t){super(),q(this,t,Z,Q,B,{})}}export{oe as component};
