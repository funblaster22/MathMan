import{s as he,i as Ge,n as X,e as se,f as Ue,r as He,o as Je,h as Qe}from"../chunks/scheduler.00dc3453.js";import{S as de,i as _e,e as re,a as T,d as N,p as Ye,b as Ke,t as Y,f as p,y as Ve,g as b,m as S,s as V,r as ie,h as k,j as w,n as D,c as I,u as oe,k as v,l as Be,x as _,v as fe,o as z,w as ue,z as Ie,A as je,B as Re}from"../chunks/index.2d86d01a.js";import{d as ce,u as Xe}from"../chunks/db.0a5d7a2c.js";import{e as $,p as U,u as Ze,o as xe,n as et}from"../chunks/index.4b0e875b.js";import{e as Z,w as tt}from"../chunks/singletons.4892ba31.js";import{p as Ae}from"../chunks/stores.3b35b2a7.js";const lt=({params:a})=>{const e=a.path.split("/");return e[0]!==""&&e.unshift(""),{path:e}},Et=Object.freeze(Object.defineProperty({__proto__:null,load:lt},Symbol.toStringTag,{value:"Module"}));function Oe(a,e,n){const t=a.slice();return t[3]=e[n],t}function Fe(a){let e,n=(a[3]||"/")+"",t,s,u,r,o;return r=new We({props:{fileStruct:a[0][a[3]],indentLevel:a[1]+1,fullPath:U.join(a[2],a[3])}}),{c(){e=b("a"),t=S(n),u=V(),ie(r.$$.fragment),this.h()},l(l){e=k(l,"A",{href:!0,class:!0});var h=w(e);t=D(h,n),h.forEach(p),u=I(l),oe(r.$$.fragment,l),this.h()},h(){v(e,"href",s=U.join("/",Z,a[2],a[3])),v(e,"class","w-full block text-left"),Be(e,"padding-left",a[1]*15+"px")},m(l,h){T(l,e,h),_(e,t),T(l,u,h),fe(r,l,h),o=!0},p(l,h){(!o||h&1)&&n!==(n=(l[3]||"/")+"")&&z(t,n),(!o||h&5&&s!==(s=U.join("/",Z,l[2],l[3])))&&v(e,"href",s),h&2&&Be(e,"padding-left",l[1]*15+"px");const g={};h&1&&(g.fileStruct=l[0][l[3]]),h&2&&(g.indentLevel=l[1]+1),h&5&&(g.fullPath=U.join(l[2],l[3])),r.$set(g)},i(l){o||(N(r.$$.fragment,l),o=!0)},o(l){Y(r.$$.fragment,l),o=!1},d(l){l&&(p(e),p(u)),ue(r,l)}}}function nt(a){let e,n,t=$(Object.keys(a[0]??{})),s=[];for(let r=0;r<t.length;r+=1)s[r]=Fe(Oe(a,t,r));const u=r=>Y(s[r],1,1,()=>{s[r]=null});return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=re()},l(r){for(let o=0;o<s.length;o+=1)s[o].l(r);e=re()},m(r,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(r,o);T(r,e,o),n=!0},p(r,[o]){if(o&7){t=$(Object.keys(r[0]??{}));let l;for(l=0;l<t.length;l+=1){const h=Oe(r,t,l);s[l]?(s[l].p(h,o),N(s[l],1)):(s[l]=Fe(h),s[l].c(),N(s[l],1),s[l].m(e.parentNode,e))}for(Ye(),l=t.length;l<s.length;l+=1)u(l);Ke()}},i(r){if(!n){for(let o=0;o<t.length;o+=1)N(s[o]);n=!0}},o(r){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)Y(s[o]);n=!1},d(r){r&&p(e),Ve(s,r)}}}function at(a,e,n){let{fileStruct:t}=e,{indentLevel:s=0}=e,{fullPath:u=""}=e;return a.$$set=r=>{"fileStruct"in r&&n(0,t=r.fileStruct),"indentLevel"in r&&n(1,s=r.indentLevel),"fullPath"in r&&n(2,u=r.fullPath)},[t,s,u]}class We extends de{constructor(e){super(),_e(this,e,at,nt,he,{fileStruct:0,indentLevel:1,fullPath:2})}}function st(a){let e,n,t,s,u,r,o=Pe(a[4].date)+"",l,h,g,d,m=a[4].duration+"",i,c,f,q,B=a[0].attempts.length+"",E,M,j,y,K,O=a[0].questions+"",x,me,F,ve,H=a[0].mistakes+"",ee,ge,P,J=a[2]?"üóëÔ∏è":"üîª",te,pe,W,G,Q=a[0].flagged?new Date().getMonth()===5?"üè≥Ô∏è‚Äçüåà ":"üö© ":"",le,R=a[0].name+"",ne,be,Me;return{c(){e=b("div"),n=b("div"),t=b("a"),s=b("div"),u=b("div"),r=S("-"),l=S(o),h=V(),g=b("div"),d=S("‚è±Ô∏è "),i=S(m),c=V(),f=b("div"),q=S("‚úèÔ∏è "),E=S(B),M=b("div"),j=V(),y=b("div"),K=S("‚ùî "),x=S(O),me=V(),F=b("div"),ve=S("‚ùå "),ee=S(H),ge=V(),P=b("button"),te=S(J),pe=V(),W=b("a"),G=b("div"),le=S(Q),ne=S(R),this.h()},l(L){e=k(L,"DIV",{class:!0});var A=w(e);n=k(A,"DIV",{class:!0});var ae=w(n);t=k(ae,"A",{href:!0});var Ce=w(t);s=k(Ce,"DIV",{class:!0});var C=w(s);u=k(C,"DIV",{class:!0,title:!0});var ke=w(u);r=D(ke,"-"),l=D(ke,o),ke.forEach(p),h=I(C),g=k(C,"DIV",{class:!0,title:!0});var Ee=w(g);d=D(Ee,"‚è±Ô∏è "),i=D(Ee,m),Ee.forEach(p),c=I(C),f=k(C,"DIV",{class:!0,title:!0});var we=w(f);q=D(we,"‚úèÔ∏è "),E=D(we,B),we.forEach(p),M=k(C,"DIV",{}),w(M).forEach(p),j=I(C),y=k(C,"DIV",{class:!0,title:!0});var ye=w(y);K=D(ye,"‚ùî "),x=D(ye,O),ye.forEach(p),me=I(C),F=k(C,"DIV",{class:!0,title:!0});var Se=w(F);ve=D(Se,"‚ùå "),ee=D(Se,H),Se.forEach(p),C.forEach(p),Ce.forEach(p),ge=I(ae),P=k(ae,"BUTTON",{class:!0,title:!0});var qe=w(P);te=D(qe,J),qe.forEach(p),ae.forEach(p),pe=I(A),W=k(A,"A",{href:!0});var Te=w(W);G=k(Te,"DIV",{});var De=w(G);le=D(De,Q),ne=D(De,R),De.forEach(p),Te.forEach(p),A.forEach(p),this.h()},h(){v(u,"class","m-auto"),v(u,"title","Time since last attempt ("+Pe(a[4].date,!1)+")"),v(g,"class","m-auto"),v(g,"title","Duration of last attempt ("+a[4].duration+" minutes)"),v(f,"class","m-auto"),v(f,"title","Number of attempts"),v(y,"class","m-auto"),v(y,"title","Number of unresolved questions"),v(F,"class","m-auto"),v(F,"title","Weighted average of incorrect problems"),v(s,"class","w-full aspect-square border m-auto grid grid-cols-2 grid-rows-3"),v(t,"href",a[3]),v(P,"class","attempt-dropdown svelte-wqw3oy"),v(P,"title","Show attempts"),v(n,"class","relative"),v(W,"href",a[3]),v(e,"class","text-center w-[6rem] mr-[11px]")},m(L,A){T(L,e,A),_(e,n),_(n,t),_(t,s),_(s,u),_(u,r),_(u,l),_(s,h),_(s,g),_(g,d),_(g,i),_(s,c),_(s,f),_(f,q),_(f,E),_(s,M),_(s,j),_(s,y),_(y,K),_(y,x),_(s,me),_(s,F),_(F,ve),_(F,ee),_(n,ge),_(n,P),_(P,te),_(e,pe),_(e,W),_(W,G),_(G,le),_(G,ne),be||(Me=Ie(P,"click",function(){Ge(a[5].bind(this,a[0].id))&&a[5].bind(this,a[0].id).apply(this,arguments)}),be=!0)},p(L,[A]){a=L,A&1&&B!==(B=a[0].attempts.length+"")&&z(E,B),A&1&&O!==(O=a[0].questions+"")&&z(x,O),A&1&&H!==(H=a[0].mistakes+"")&&z(ee,H),A&4&&J!==(J=a[2]?"üóëÔ∏è":"üîª")&&z(te,J),A&1&&Q!==(Q=a[0].flagged?new Date().getMonth()===5?"üè≥Ô∏è‚Äçüåà ":"üö© ":"")&&z(le,Q),A&1&&R!==(R=a[0].name+"")&&z(ne,R)},i:X,o:X,d(L){L&&p(e),be=!1,Me()}}}function Pe(a,e=!0){const n=new Date,t=(n.getTime()-a.getTime())/(1e3*60*60*24);if(t<=10)return Math.floor(t)+(e?"d":" days");const s=t/7;if(s<=16)return Math.floor(s)+(e?"w":" weeks");const r=(n.getFullYear()-a.getFullYear())*12+(n.getMonth()-a.getMonth());return r<12?r+(e?"m":" months"):Math.floor(r/12)+(e?"y":" years")}function rt(a,e,n){let t,s=X,u=()=>(s(),s=Ue(l,m=>n(2,t=m)),l),r;se(a,Ae,m=>n(6,r=m)),a.$$.on_destroy.push(()=>s());let{file:o}=e,{deleteEnabled:l}=e;u();const h=U.join("/",Z,r.params.path,o.id.toString()),g=function(m){return m.attempts.length===0?{date:new Date(0),duration:0}:m.attempts.reduce((i,c)=>c.date>i.date?c:i)}(o);function d(m){t&&ce.files.delete(m)}return a.$$set=m=>{"file"in m&&n(0,o=m.file),"deleteEnabled"in m&&u(n(1,l=m.deleteEnabled))},[o,l,t,h,g,d]}class it extends de{constructor(e){super(),_e(this,e,rt,st,he,{file:0,deleteEnabled:1})}}function ot(a,e,n){const t=a.slice();return t[6]=e[n],t}function ze(a,e,n){const t=a.slice();return t[9]=e[n],t}function Ne(a,e,n){const t=a.slice();return t[12]=e[n],t}function Le(a){let e,n,t="üìÅ",s,u=a[12]+"",r,o;return{c(){e=b("a"),n=b("div"),n.textContent=t,s=V(),r=S(u),this.h()},l(l){e=k(l,"A",{href:!0,class:!0});var h=w(e);n=k(h,"DIV",{class:!0,"data-svelte-h":!0}),je(n)!=="svelte-4573lq"&&(n.textContent=t),s=I(h),r=D(h,u),h.forEach(p),this.h()},h(){v(n,"class","text-7xl aspect-square perfect-center font-mono"),v(e,"href",o=U.join("/",Z,a[2].params.path,a[12])),v(e,"class","text-center w-[6rem]")},m(l,h){T(l,e,h),_(e,n),_(e,s),_(e,r)},p(l,h){h&2&&u!==(u=l[12]+"")&&z(r,u),h&6&&o!==(o=U.join("/",Z,l[2].params.path,l[12]))&&v(e,"href",o)},d(l){l&&p(e)}}}function $e(a,e){let n,t,s;return t=new it({props:{file:e[9],deleteEnabled:e[0]}}),{key:a,first:null,c(){n=re(),ie(t.$$.fragment),this.h()},l(u){n=re(),oe(t.$$.fragment,u),this.h()},h(){this.first=n},m(u,r){T(u,n,r),fe(t,u,r),s=!0},p(u,r){e=u;const o={};r&16&&(o.file=e[9]),r&1&&(o.deleteEnabled=e[0]),t.$set(o)},i(u){s||(N(t.$$.fragment,u),s=!0)},o(u){Y(t.$$.fragment,u),s=!1},d(u){u&&p(n),ue(t,u)}}}function ft(a){let e;return{c(){e=b("div"),this.h()},l(n){e=k(n,"DIV",{class:!0}),w(e).forEach(p),this.h()},h(){v(e,"class","w-[6rem] mr-[11px]")},m(n,t){T(n,e,t)},p:X,d(n){n&&p(e)}}}function ut(a){let e,n,t=[],s=new Map,u,r,o=$(Object.keys(a[1])),l=[];for(let i=0;i<o.length;i+=1)l[i]=Le(Ne(a,o,i));let h=$(a[4]??[]);const g=i=>i[9].id;for(let i=0;i<h.length;i+=1){let c=ze(a,h,i),f=g(c);s.set(f,t[i]=$e(f,c))}let d=$(Array(10)),m=[];for(let i=0;i<d.length;i+=1)m[i]=ft(ot(a,d,i));return{c(){e=b("div");for(let i=0;i<l.length;i+=1)l[i].c();n=V();for(let i=0;i<t.length;i+=1)t[i].c();u=V();for(let i=0;i<m.length;i+=1)m[i].c();this.h()},l(i){e=k(i,"DIV",{class:!0});var c=w(e);for(let f=0;f<l.length;f+=1)l[f].l(c);n=I(c);for(let f=0;f<t.length;f+=1)t[f].l(c);u=I(c);for(let f=0;f<m.length;f+=1)m[f].l(c);c.forEach(p),this.h()},h(){v(e,"class","flex flex-wrap justify-evenly gap-3")},m(i,c){T(i,e,c);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);_(e,n);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);_(e,u);for(let f=0;f<m.length;f+=1)m[f]&&m[f].m(e,null);r=!0},p(i,[c]){if(c&6){o=$(Object.keys(i[1]));let f;for(f=0;f<o.length;f+=1){const q=Ne(i,o,f);l[f]?l[f].p(q,c):(l[f]=Le(q),l[f].c(),l[f].m(e,n))}for(;f<l.length;f+=1)l[f].d(1);l.length=o.length}c&17&&(h=$(i[4]??[]),Ye(),t=Ze(t,c,g,1,i,h,s,e,xe,$e,u,ze),Ke())},i(i){if(!r){for(let c=0;c<h.length;c+=1)N(t[c]);r=!0}},o(i){for(let c=0;c<t.length;c+=1)Y(t[c]);r=!1},d(i){i&&p(e),Ve(l,i);for(let c=0;c<t.length;c+=1)t[c].d();Ve(m,i)}}}function ct(a,e,n){let t,s,u=X,r=()=>(u(),u=Ue(g,d=>n(4,s=d)),g);se(a,Ae,d=>n(2,t=d)),a.$$.on_destroy.push(()=>u());let{fileStruct:o}=e,{deleteEnabled:l}=e,h={},g;return a.$$set=d=>{"fileStruct"in d&&n(5,o=d.fileStruct),"deleteEnabled"in d&&n(0,l=d.deleteEnabled)},a.$$.update=()=>{if(a.$$.dirty&38&&o[""]!=null&&(n(1,h=o[""]),t.params.path!==""))for(const d of t.params.path.split("/"))n(1,h=h[d]);a.$$.dirty&4&&r(n(3,g=Xe(()=>ce.files.where({"[route]":[["",...t.params.path?t.params.path.split("/"):[]]]}).toArray())))},[l,h,t,g,s,o]}class ht extends de{constructor(e){super(),_e(this,e,ct,ut,he,{fileStruct:5,deleteEnabled:0})}}function dt(a){let e,n,t,s,u="üóëÔ∏è file",r,o,l="‚ûï file",h,g,d,m,i,c,f,q,B;return d=new We({props:{fileStruct:a[0]}}),c=new ht({props:{fileStruct:a[0],deleteEnabled:a[2]}}),{c(){e=V(),n=b("div"),t=b("div"),s=b("button"),s.textContent=u,r=V(),o=b("button"),o.textContent=l,h=V(),g=b("div"),ie(d.$$.fragment),m=V(),i=b("div"),ie(c.$$.fragment),this.h()},l(E){Re("svelte-8s10wx",document.head).forEach(p),e=I(E),n=k(E,"DIV",{id:!0,class:!0});var j=w(n);t=k(j,"DIV",{id:!0,class:!0});var y=w(t);s=k(y,"BUTTON",{"data-svelte-h":!0}),je(s)!=="svelte-1e4eght"&&(s.textContent=u),r=I(y),o=k(y,"BUTTON",{"data-svelte-h":!0}),je(o)!=="svelte-k3nzco"&&(o.textContent=l),y.forEach(p),h=I(j),g=k(j,"DIV",{id:!0,class:!0});var K=w(g);oe(d.$$.fragment,K),K.forEach(p),m=I(j),i=k(j,"DIV",{id:!0,class:!0});var O=w(i);oe(c.$$.fragment,O),O.forEach(p),j.forEach(p),this.h()},h(){document.title="MathMan Browse",v(t,"id","ribbon"),v(t,"class","text-right svelte-1huhyzt"),v(g,"id","folders"),v(g,"class","svelte-1huhyzt"),v(i,"id","files"),v(i,"class","svelte-1huhyzt"),v(n,"id","grid"),v(n,"class","svelte-1huhyzt")},m(E,M){T(E,e,M),T(E,n,M),_(n,t),_(t,s),_(t,r),_(t,o),_(n,h),_(n,g),fe(d,g,null),_(n,m),_(n,i),fe(c,i,null),f=!0,q||(B=[Ie(s,"click",a[4]),Ie(o,"click",a[5])],q=!0)},p(E,[M]){const j={};M&1&&(j.fileStruct=E[0]),d.$set(j);const y={};M&1&&(y.fileStruct=E[0]),c.$set(y)},i(E){f||(N(d.$$.fragment,E),N(c.$$.fragment,E),f=!0)},o(E){Y(d.$$.fragment,E),Y(c.$$.fragment,E),f=!1},d(E){E&&(p(e),p(n)),ue(d),ue(c),q=!1,He(B)}}}function _t(a,e,n){let t,s;se(a,Ae,d=>n(6,t=d));let u={};const r=tt(!1);se(a,r,d=>n(1,s=d));async function o(){const d={},m=await ce.files.orderBy("[route]").uniqueKeys().then(i=>i.flat(1));for(const i of m){let c=d;for(const f of i)f in c||(c[f]={}),c=c[f]}return d}function l(...d){var m;if(d.length===0){const i=(m=prompt("Enter path of file to create"))==null?void 0:m.split("/");if(i==null)return;if(i[0]===""){alert("Need at least filename");return}d=i}d.unshift(...t.data.path),ce.files.add({attempts:[et()],parent:d.at(-2)??"",route:d.slice(0,d.length-1),name:d.at(-1),questions:0,mistakes:0,flagged:!1})}return Je(()=>{o().then(d=>n(0,u=d))}),[u,s,r,l,()=>Qe(r,s=!s,s),()=>l()]}class wt extends de{constructor(e){super(),_e(this,e,_t,dt,he,{})}}export{wt as component,Et as universal};
