import{s as j,n as E,b as B,q as T,e as W,o as $,v as A}from"../chunks/scheduler.d208cd37.js";import{S as O,i as q,g as v,h as _,j as b,f as d,k as x,l as D,a as z,x as I,A as C,I as H,s as V,r as N,c as M,u as P,v as R,d as S,t as U,w as X}from"../chunks/index.c95bd50b.js";import{d as Y}from"../chunks/db.d805690e.js";import{p as F}from"../chunks/stores.d06b2a3b.js";function G(c){let t,n,a,o;return{c(){t=v("div"),n=v("div"),this.h()},l(e){t=_(e,"DIV",{class:!0});var i=b(t);n=_(i,"DIV",{class:!0}),b(n).forEach(d),i.forEach(d),this.h()},h(){x(n,"class","absolute right-0 bottom-0 w-5 h-5 bg-red-50 cursor-nw-resize svelte-1o3tvyk"),x(t,"class","relative overflow-auto border min-w-12 min-h-12 svelte-1o3tvyk"),D(t,"width",c[0][0]+"px"),D(t,"height",c[0][1]+"px")},m(e,i){z(e,t,i),I(t,n),a||(o=C(n,"pointerdown",c[1]),a=!0)},p(e,[i]){i&1&&D(t,"width",e[0][0]+"px"),i&1&&D(t,"height",e[0][1]+"px")},i:E,o:E,d(e){e&&d(t),a=!1,o()}}}function J(){document.onpointermove=document.onpointerup=null,console.log("drag stopped")}function K(c,t,n){let{size:a=[170,70]}=t;function o(){document.onpointermove=e,document.onpointerup=J,console.log("starting drag")}function e(i){n(0,a[0]+=i.movementX,a),n(0,a[1]+=i.movementY,a),console.log(a,i.movementX,i.movementY)}return c.$$set=i=>{"size"in i&&n(0,a=i.size)},[a,o]}class L extends O{constructor(t){super(),q(this,t,K,G,j,{size:0})}}function Q(c){let t,n,a,o,e,i,w,u,h,r,m,f;function p(s){c[4](s)}let y={};return c[1]!==void 0&&(y.size=c[1]),e=new L({props:y}),B.push(()=>H(e,"size",p)),{c(){t=v("div"),n=v("video"),a=V(),o=v("div"),N(e.$$.fragment),w=V(),u=v("div"),h=v("button"),this.h()},l(s){t=_(s,"DIV",{class:!0});var l=b(t);n=_(l,"VIDEO",{class:!0}),b(n).forEach(d),l.forEach(d),a=M(s),o=_(s,"DIV",{class:!0});var g=b(o);P(e.$$.fragment,g),g.forEach(d),w=M(s),u=_(s,"DIV",{class:!0});var k=b(u);h=_(k,"BUTTON",{class:!0}),b(h).forEach(d),k.forEach(d),this.h()},h(){x(n,"class","w-full"),x(t,"class","fixed inset-x-0 inset-y-0"),x(o,"class","fixed w-full h-[60vh] inset-x-0 top-0 flex items-center justify-center"),x(h,"class","rounded-full bg-gray-200 m-auto block w-12 h-12"),x(u,"class","fixed inset-x-0 bottom-12")},m(s,l){z(s,t,l),I(t,n),c[3](n),z(s,a,l),z(s,o,l),R(e,o,null),z(s,w,l),z(s,u,l),I(u,h),r=!0,m||(f=C(h,"click",c[2]),m=!0)},p(s,[l]){const g={};!i&&l&2&&(i=!0,g.size=s[1],T(()=>i=!1)),e.$set(g)},i(s){r||(S(e.$$.fragment,s),r=!0)},o(s){U(e.$$.fragment,s),r=!1},d(s){s&&(d(t),d(a),d(o),d(w),d(u)),c[3](null),X(e),m=!1,f()}}}function Z(c,t,n){let a;W(c,F,r=>n(5,a=r));let o,e;$(()=>{navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1}).then(r=>{n(0,o.srcObject=r,o),o.play()}).catch(r=>{console.error(`An error occurred: ${r}`)})}),A(()=>{o.srcObject.getVideoTracks()[0].stop()});function i(r){const[m,f]=[o.videoWidth,o.videoHeight],p=document.createElement("canvas");p.width=m,p.height=f;const y=p.getContext("2d");y.drawImage(o,0,0,m,f);const s=w(),l=m/window.innerWidth,g=y.getImageData(s.x*l,s.y*l,s.width*l,s.height*l);Y.files.update(Number.parseInt(a.params.problemId),{question:g}).then(()=>history.back())}function w(){const{clientWidth:r,clientHeight:m}=document.documentElement,f=r/2,p=m*.3;return{x:Math.round(f-e[0]/2),y:Math.round(p-e[1]/2),width:e[0],height:e[1]}}function u(r){B[r?"unshift":"push"](()=>{o=r,n(0,o)})}function h(r){e=r,n(1,e)}return[o,e,i,u,h]}class ne extends O{constructor(t){super(),q(this,t,Z,Q,j,{})}}export{ne as component};
