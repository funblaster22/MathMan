import{s as B,n as I,e as Z,f as x,o as ee}from"../chunks/scheduler.03df403d.js";import{S as C,i as N,e as T,a as w,d as k,p as te,b as le,t as S,f as d,y as ae,g as v,m as R,s as E,r as P,h as g,j as b,n as W,c as D,u as L,k as h,l as K,x as m,v as z,o as X,w as A,z as se,A as ne}from"../chunks/index.5bc90a32.js";import{e as j,p as V,u as re,a as ie,d as F,b as oe,n as fe}from"../chunks/index.83a2109c.js";import{e as U,r as ce}from"../chunks/singletons.c8bc6e4f.js";import{p as ue}from"../chunks/stores.d00e3046.js";function G(i,a,s){const r=i.slice();return r[3]=a[s],r}function H(i){let a,s=(i[3]||"/")+"",r,n,f,e,l;return e=new Y({props:{fileStruct:i[0][i[3]],indentLevel:i[1]+1,fullPath:V.join(i[2],i[3])}}),{c(){a=v("a"),r=R(s),f=E(),P(e.$$.fragment),this.h()},l(t){a=g(t,"A",{href:!0,class:!0});var o=b(a);r=W(o,s),o.forEach(d),f=D(t),L(e.$$.fragment,t),this.h()},h(){h(a,"href",n=V.join("/",U,i[2],i[3])),h(a,"class","w-full block text-left"),K(a,"padding-left",i[1]*15+"px")},m(t,o){w(t,a,o),m(a,r),w(t,f,o),z(e,t,o),l=!0},p(t,o){(!l||o&1)&&s!==(s=(t[3]||"/")+"")&&X(r,s),(!l||o&5&&n!==(n=V.join("/",U,t[2],t[3])))&&h(a,"href",n),o&2&&K(a,"padding-left",t[1]*15+"px");const c={};o&1&&(c.fileStruct=t[0][t[3]]),o&2&&(c.indentLevel=t[1]+1),o&5&&(c.fullPath=V.join(t[2],t[3])),e.$set(c)},i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){t&&(d(a),d(f)),A(e,t)}}}function he(i){let a,s,r=j(Object.keys(i[0]??{})),n=[];for(let e=0;e<r.length;e+=1)n[e]=H(G(i,r,e));const f=e=>S(n[e],1,1,()=>{n[e]=null});return{c(){for(let e=0;e<n.length;e+=1)n[e].c();a=T()},l(e){for(let l=0;l<n.length;l+=1)n[l].l(e);a=T()},m(e,l){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,l);w(e,a,l),s=!0},p(e,[l]){if(l&7){r=j(Object.keys(e[0]??{}));let t;for(t=0;t<r.length;t+=1){const o=G(e,r,t);n[t]?(n[t].p(o,l),k(n[t],1)):(n[t]=H(o),n[t].c(),k(n[t],1),n[t].m(a.parentNode,a))}for(te(),t=r.length;t<n.length;t+=1)f(t);le()}},i(e){if(!s){for(let l=0;l<r.length;l+=1)k(n[l]);s=!0}},o(e){n=n.filter(Boolean);for(let l=0;l<n.length;l+=1)S(n[l]);s=!1},d(e){e&&d(a),ae(n,e)}}}function de(i,a,s){let{fileStruct:r}=a,{indentLevel:n=0}=a,{fullPath:f=""}=a;return i.$$set=e=>{"fileStruct"in e&&s(0,r=e.fileStruct),"indentLevel"in e&&s(1,n=e.indentLevel),"fullPath"in e&&s(2,f=e.fullPath)},[r,n,f]}class Y extends C{constructor(a){super(),N(this,a,de,he,B,{fileStruct:0,indentLevel:1,fullPath:2})}}function J(i,a,s){const r=i.slice();return r[3]=a[s],r}function Q(i,a){let s,r,n,f,e=a[3].name+"",l,t,o;return{key:i,first:null,c(){s=v("a"),r=v("div"),n=E(),f=v("div"),l=R(e),t=E(),this.h()},l(c){s=g(c,"A",{class:!0,href:!0});var u=b(s);r=g(u,"DIV",{class:!0}),b(r).forEach(d),n=D(u),f=g(u,"DIV",{});var $=b(f);l=W($,e),$.forEach(d),t=D(u),u.forEach(d),this.h()},h(){h(r,"class","w-12 h-12 bg-red-500 m-auto"),h(s,"class","text-center"),h(s,"href",o=a[3].id),this.first=s},m(c,u){w(c,s,u),m(s,r),m(s,n),m(s,f),m(f,l),m(s,t)},p(c,u){a=c,u&2&&e!==(e=a[3].name+"")&&X(l,e),u&2&&o!==(o=a[3].id)&&h(s,"href",o)},d(c){c&&d(s)}}}function _e(i){let a,s=[],r=new Map,n=j(i[1]);const f=e=>e[3].id;for(let e=0;e<n.length;e+=1){let l=J(i,n,e),t=f(l);r.set(t,s[e]=Q(t,l))}return{c(){a=v("div");for(let e=0;e<s.length;e+=1)s[e].c();this.h()},l(e){a=g(e,"DIV",{class:!0});var l=b(a);for(let t=0;t<s.length;t+=1)s[t].l(l);l.forEach(d),this.h()},h(){h(a,"class","flex flex-wrap gap-5")},m(e,l){w(e,a,l);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(a,null)},p(e,[l]){l&2&&(n=j(e[1]),s=re(s,l,f,1,e,n,r,a,oe,Q,null,J))},i:I,o:I,d(e){e&&d(a);for(let l=0;l<s.length;l+=1)s[l].d()}}}function me(i,a,s){let r,n,f=I,e=()=>(f(),f=x(l,t=>s(1,n=t)),l);Z(i,ue,t=>s(2,r=t)),i.$$.on_destroy.push(()=>f());let l=ce([]);return e(),i.$$.update=()=>{i.$$.dirty&4&&e(s(0,l=ie(()=>F.files.where({"[route]":[["",...r.params.path?r.params.path.split("/"):[]]]}).toArray())))},[l,n,r]}class pe extends C{constructor(a){super(),N(this,a,me,_e,B,{})}}function ve(i){let a,s,r,n="âž• file",f,e,l,t,o,c,u,$,O;return l=new Y({props:{fileStruct:i[0]}}),c=new pe({}),{c(){a=v("div"),s=v("div"),r=v("button"),r.textContent=n,f=E(),e=v("div"),P(l.$$.fragment),t=E(),o=v("div"),P(c.$$.fragment),this.h()},l(_){a=g(_,"DIV",{id:!0,class:!0});var p=b(a);s=g(p,"DIV",{id:!0,class:!0});var y=b(s);r=g(y,"BUTTON",{"data-svelte-h":!0}),se(r)!=="svelte-1m4mbow"&&(r.textContent=n),y.forEach(d),f=D(p),e=g(p,"DIV",{id:!0,class:!0});var q=b(e);L(l.$$.fragment,q),q.forEach(d),t=D(p),o=g(p,"DIV",{id:!0,class:!0});var M=b(o);L(c.$$.fragment,M),M.forEach(d),p.forEach(d),this.h()},h(){h(s,"id","ribbon"),h(s,"class","text-right svelte-1huhyzt"),h(e,"id","folders"),h(e,"class","svelte-1huhyzt"),h(o,"id","files"),h(o,"class","svelte-1huhyzt"),h(a,"id","grid"),h(a,"class","svelte-1huhyzt")},m(_,p){w(_,a,p),m(a,s),m(s,r),m(a,f),m(a,e),z(l,e,null),m(a,t),m(a,o),z(c,o,null),u=!0,$||(O=ne(r,"click",i[2]),$=!0)},p(_,[p]){const y={};p&1&&(y.fileStruct=_[0]),l.$set(y)},i(_){u||(k(l.$$.fragment,_),k(c.$$.fragment,_),u=!0)},o(_){S(l.$$.fragment,_),S(c.$$.fragment,_),u=!1},d(_){_&&d(a),A(l),A(c),$=!1,O()}}}function ge(i,a,s){let r={};async function n(){const l={},t=await F.files.orderBy("[route]").uniqueKeys().then(o=>o.flat(1));for(const o of t){let c=l;for(const u of o)u in c||(c[u]={}),c=c[u]}return l}function f(...l){if(l.length<1)throw"Need at least filename";F.files.add({attempts:[fe()],parent:l.at(-2)??"",route:["",...l.slice(0,l.length-1)],name:l.at(-1)})}return ee(()=>{window.newFile=f,n().then(l=>s(0,r=l))}),[r,f,()=>f(...prompt("Enter path of file to create").split("/"))]}class Se extends C{constructor(a){super(),N(this,a,ge,ve,B,{})}}export{Se as component};
